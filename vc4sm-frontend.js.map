{"version":3,"file":"vc4sm-frontend.js","sources":["../vendor/toolkit/packages/common/src/eventbus.js","../vendor/toolkit/packages/app-shell/src/i18n.js","../vendor/toolkit/packages/language-select/src/i18n.js","../vendor/toolkit/packages/language-select/src/language-select.js","../vendor/toolkit/packages/auth/src/i18n.js","../vendor/toolkit/packages/common/notification.js","../vendor/toolkit/packages/common/i18n.js","../vendor/toolkit/packages/common/jsonld.js","../node_modules/event-target-shim/dist/event-target-shim.mjs","../vendor/toolkit/packages/auth/src/keycloak.js","../vendor/toolkit/packages/auth/src/util.js","../vendor/toolkit/packages/auth/src/auth-keycloak.js","../vendor/toolkit/packages/auth/src/login-button.js","../vendor/toolkit/packages/app-shell/src/auth-menu-button.js","../vendor/toolkit/packages/notification/src/i18n.js","../vendor/toolkit/packages/notification/src/notification.js","../vendor/toolkit/packages/notification/src/utils.js","../consts:buildinfo","../node_modules/path-to-regexp/dist.es2015/index.js","../node_modules/universal-router/module.js","../node_modules/universal-router/generateUrls/module.js","../vendor/toolkit/packages/app-shell/src/router.js","../vendor/toolkit/packages/app-shell/src/build-info.js","../vendor/toolkit/packages/app-shell/src/tugraz-logo.js","../vendor/toolkit/packages/app-shell/src/dbp-app-shell-welcome.js","../vendor/toolkit/packages/matomo/src/i18n.js","../vendor/toolkit/packages/matomo/src/matomo.js","../vendor/toolkit/packages/app-shell/src/app-shell.js","../src/vc4sm-frontend.js"],"sourcesContent":["\nconst OPERATION_FETCH_RETAINED = 'fetch-retained';\n\nexport function checkIndentifier(name, allowEmpty=false) {\n    if (name.length === 0 && allowEmpty)\n        return;\n    // we are strict here, so we can used special characters to extend the format later on\n    if (!/^[a-z]+[a-z0-9-]*$/.test(name)) {\n        throw new Error('Only a-z0-9 and - allowed: ' + JSON.stringify(name));\n    }\n}\n\nexport function createEventName(busName, eventName, operation) {\n    checkIndentifier(busName, true);\n    checkIndentifier(eventName);\n    let result = 'dbp' + ':' + busName + ':' + eventName;\n    if (operation !== undefined) {\n        checkIndentifier(operation);\n        result += ':' + operation;\n    }\n    return result;\n}\n\n/**\n * An event bus implementation which doesn't depend on a global bus instance and supports retained messages\n * (similar to MQTT retained messages)\n */\nexport class EventBus\n{\n    /**\n     * @param {object} options\n     * @param {string} options.name The bus name, events will only be visible on the same bus\n     */\n    constructor(options={}) {\n        const {name = ''} = options;\n        this._busName = name;\n        this._retainedData = {};\n        this._retainedListeners = {};\n        this._listeners = {};\n    }\n\n    _name(name, operation) {\n        return createEventName(this._busName, name, operation);\n    }\n\n    /**\n     * Subscribe to an event. Note that this will immediately trigger the callback in case there exists a\n     * retained event on the bus.\n     *\n     * @param {string} name The event name\n     * @param {Function} callback The callback to call in case the event is received\n     */\n    subscribe(name, callback) {\n        const listeners = this._listeners[name] || new Map();\n\n        if (listeners.has(callback)) {\n            throw new Error('already subscribed to: ' + JSON.stringify(name));\n        }\n\n        const eventHandler = (e) => {\n            const meta = {};\n            const detail = e.detail;\n            if (detail.retain !== undefined)\n                meta.retain = detail.retain;\n            callback(detail.data, meta);\n            e.preventDefault();\n        };\n\n        window.addEventListener(this._name(name), eventHandler);\n\n        this._listeners[name] = listeners.set(callback, eventHandler);\n\n        const fetchEvent = new CustomEvent(this._name(name, OPERATION_FETCH_RETAINED), {\n            detail: {callback: eventHandler}\n        });\n        window.dispatchEvent(fetchEvent);\n    }\n\n    /**\n     * Unsubscribe from an event given the name and callback used for subscribing.\n     *\n     * @param {string} name The event name\n     * @param {Function} callback The callback used when calling subscribe()\n     */\n    unsubscribe(name, callback) {\n        const listeners = this._listeners[name] || new Map();\n        const eventHandler = listeners.get(callback);\n        if (eventHandler === undefined) {\n            throw new Error(\"Not subscribed to: \" + name);\n        }\n        window.removeEventListener(this._name(name), eventHandler);\n        listeners.delete(callback);\n    }\n\n    /**\n     * Publish a value for an event name. Set the retained flag to send the event also to future subscribers.\n     *\n     * @param {string} name \n     * @param {any} data \n     * @param {object} options\n     * @param {boolean} options.retain If the event should be retained i.e. send to all future subscribers as well\n     * @returns {boolean} If the event was handled by at least one bus member.\n     */\n    publish(name, data, options={}) {\n        const {retain = false} = options;\n        const eventName = this._name(name);\n\n        if (retain && this._retainedListeners[name] === undefined) {\n            const retainedEventHandler = (e) => {\n                const data = this._retainedData[name];\n                if (data !== undefined) {\n                    const callback = e.detail['callback'];\n                    e.stopImmediatePropagation();\n                    const event = new CustomEvent(eventName, {detail: {data: data, retain: retain}});\n                    callback(event);\n                }\n            };\n            window.addEventListener(this._name(name, OPERATION_FETCH_RETAINED), retainedEventHandler);\n\n            const eventHandler = (e) => {\n                const detail = e.detail;\n                if (detail.retain) {\n                    this._retainedData[name] = detail.data;\n                }\n            };\n            window.addEventListener(eventName, eventHandler);\n\n            this._retainedListeners[name] = [retainedEventHandler, eventHandler];\n        }\n\n        const event = new CustomEvent(eventName, {detail: {data: data, retain: retain}, cancelable: true});\n        return !window.dispatchEvent(event);\n    }\n\n    /**\n     * Cleans up all subscriptions, retained messages and other event handlers.\n     *\n     * This _needs_ to be called for every bus instance at some point.\n     * Otherwise the callbacks will stay alive forever and will leak.\n     */\n    close() {\n        for (const [name, funcs] of Object.entries(this._retainedListeners)) {\n            const [retainedHandler, handler] = funcs;\n            window.removeEventListener(this._name(name, OPERATION_FETCH_RETAINED), retainedHandler);\n            window.removeEventListener(this._name(name), handler);\n            delete this._retainedListeners[name];\n            delete this._retainedData[name];\n        }\n        for (const [name, callbacks] of Object.entries(this._listeners)) {\n            for (const callback of callbacks.keys()) {\n                this.unsubscribe(name, callback);\n            }\n        }\n    }\n}\n","import {createInstance} from '@dbp-toolkit/common/i18next.js';\n\nimport de from './i18n/de/translation.json';\nimport en from './i18n/en/translation.json';\n\nconst i18n = createInstance({en: en, de: de}, 'de', 'en');\n\nexport function createI18nInstance () {\n    return i18n.cloneInstance();\n}\n\n/**\n * Dummy function to mark strings as i18next keys for i18next-scanner\n *\n * @param {string} key\n * @returns {string} The key param as is\n */\nexport function i18nKey(key) {\n    return key;\n}","import {createInstance} from '@dbp-toolkit/common/i18next.js';\n\nimport de from './i18n/de/translation.json';\nimport en from './i18n/en/translation.json';\n\nexport const i18n = createInstance({en: en, de: de}, 'de', 'en');","import {html, css, LitElement} from 'lit-element';\nimport {i18n} from './i18n.js';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\n\n/**\n * Emits a dbp-language-changed event where event.detail.lang is the new selected language\n */\nexport class LanguageSelect extends LitElement {\n\n    constructor() {\n        super();\n        this._lang = 'de';\n        this.languages = ['de', 'en'];\n\n        this.onExternalChange = this.onExternalChange.bind(this);\n\n        // for the i18next scanner\n        i18n.t('de');\n        i18n.t('de-action');\n        i18n.t('en');\n        i18n.t('en-action');\n    }\n\n    _getNextLanguage(lang) {\n        var index = this.languages.indexOf(lang);\n        var next = this.languages[index + 1];\n        if (typeof next === 'undefined')\n            next = this.languages[0];\n        return next;\n    }\n\n    _getPreviousLanguage(lang) {\n        var index = this.languages.indexOf(lang);\n        var prev = this.languages[index - 1];\n        if (typeof prev === 'undefined')\n            prev = this.languages[this.languages.length - 1];\n        return prev;\n    }\n\n    static get properties() {\n        return {\n            lang: {type: String},\n            next: {type: String},\n            languages: {type: Array},\n        };\n    }\n\n    set lang(value) {\n        const oldValue = this.lang;\n        const oldNext = this.next;\n        this._lang = value;\n        this.requestUpdate('lang', oldValue);\n        this.requestUpdate('next', oldNext);\n\n        if (oldValue !== value) {\n            const event = new CustomEvent(\"dbp-language-changed\", {\n                bubbles: true,\n                composed: true,\n                detail: {'lang': value}\n            });\n            this.dispatchEvent(event);\n\n            // Unlike other cases we use the next language for the translations so that\n            // users not knowing the current language can understand it.\n            // In case of more than two this doesn't make that much sense, but for now..\n            i18n.changeLanguage(this.next);\n        }\n    }\n\n    get lang() {\n        return this._lang;\n    }\n\n    set next(value) {\n        this.lang = this._getPreviousLanguage(value);\n    }\n\n    get next() {\n        return this._getNextLanguage(this.lang);\n    }\n\n    static get styles() {\n        // language=css\n        return [commonStyles.getThemeCSS(),\n            css`\n            :host {\n                display: inline-block;\n            }\n\n            a:hover {\n                background-color: var(--dbp-dark);\n                color: var(--dbp-light);\n                transition: none;\n            }\n\n            a {\n                padding: 0.3em;\n                display: inline-block;\n                text-decoration: none;\n                transition: background-color 0.15s, color 0.15s;\n                color: var(--dbp-dark);\n                border-radius: var(--dbp-border-radius);\n            }\n            `\n        ];\n    }\n\n    onExternalChange(e) {\n        this.lang = e.detail.lang\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n        window.addEventListener('dbp-language-changed', this.onExternalChange);\n    }\n\n    disconnectedCallback() {\n        document.removeEventListener('dbp-language-changed', this.onExternalChange);\n        super.disconnectedCallback();\n    }\n\n    onClick(e) {\n        e.preventDefault();\n        this.lang = this.next;\n    }\n\n    render() {\n        var linkTitle = i18n.t(this.next + '-action');\n        return html`\n            <a href=\"#\" title=\"${linkTitle}\" @click=${this.onClick}>${this.next.toUpperCase()}</a>\n        `;\n    }\n}","import {createInstance} from '@dbp-toolkit/common/i18next.js';\n\nimport de from './i18n/de/translation.json';\nimport en from './i18n/en/translation.json';\n\nexport const i18n = createInstance({en: en, de: de}, 'de', 'en');","/**\n * Sends a notification via the event\n *\n * Type can be info/success/warning/danger\n *\n * example options:\n *\n * {\n *   \"summary\": \"Item deleted\",\n *   \"body\": \"Item foo was deleted!\",\n *   \"type\": \"info\",\n *   \"timeout\": 5,\n * }\n *\n * @param options\n */\nfunction send(options) {\n    const event = new CustomEvent(\"dbp-notification-send\", {\n        bubbles: true,\n        cancelable: true,\n        detail: options,\n    });\n\n    const result = window.dispatchEvent(event);\n\n    // true means the event was not handled\n    if (result) {\n        alert((options.summary !== undefined && options.summary !== \"\" ? options.summary + \": \" : \"\") + options.body);\n        console.log(\"Use the web component dbp-notification to show fancy notifications.\");\n    }\n}\n\nexport { send };\n","import {createInstance} from './i18next.js';\n\nimport de from './i18n/de/translation.json';\nimport en from './i18n/en/translation.json';\n\nexport const i18n = createInstance({en: en, de: de}, 'de', 'en');","\"use strict\";\n\nimport {send as notify} from './notification';\nimport * as utils from \"./utils\";\nimport {i18n} from \"./i18n\";\n\nlet instances = {};\nlet successFunctions = {};\nlet failureFunctions = {};\nlet initStarted = {};\n\n// \"module.exports = class JSONLD\" doesn't work with rollup because of above \"import\"\nexport default class JSONLD {\n    constructor(baseApiUrl, entities) {\n        this.entities = entities;\n        this.baseApiUrl = baseApiUrl;\n\n        let idToEntityNameMatchList = {};\n        for (const entityName in entities) {\n            const id = entities[entityName][\"@id\"];\n            idToEntityNameMatchList[id] = entityName;\n        }\n\n        this.idToEntityNameMatchList = idToEntityNameMatchList;\n    }\n\n    static initialize(apiUrl, successFnc, failureFnc, lang = 'de') {\n        if (lang !== 'de') {\n            i18n.changeLanguage(lang);\n        }\n\n        // if init api call was already successfully finished execute the success function\n        if (instances[apiUrl] !== undefined) {\n            if (typeof successFnc == 'function') successFnc(instances[apiUrl]);\n\n            return;\n        }\n\n        // init the arrays\n        if (successFunctions[apiUrl] === undefined) successFunctions[apiUrl] = [];\n        if (failureFunctions[apiUrl] === undefined) failureFunctions[apiUrl] = [];\n\n        // add success and failure functions\n        if (typeof successFnc == 'function') successFunctions[apiUrl].push(successFnc);\n        if (typeof failureFnc == 'function') failureFunctions[apiUrl].push(failureFnc);\n\n        // check if api call was already started\n        if (initStarted[apiUrl] !== undefined) {\n            return;\n        }\n\n        initStarted[apiUrl] = true;\n\n        if (window.DBPAuthToken !== undefined) {\n            JSONLD.doInitialization(apiUrl);\n        } else {\n            // window.DBPAuthToken will be set by dbp-auth-init event\n            window.addEventListener(\"dbp-auth-init\", () => JSONLD.doInitialization(apiUrl));\n        }\n    }\n\n    static doInitialization(apiUrl) {\n        const xhr = new XMLHttpRequest();\n        xhr.open(\"GET\", apiUrl, true);\n        xhr.setRequestHeader('Authorization', 'Bearer ' + window.DBPAuthToken);\n\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState !== 4) {\n                return;\n            }\n\n            if (xhr.status === 200) {\n                const json = JSON.parse(xhr.responseText);\n\n                let entryPoints = {};\n                for (let property in json) {\n                    // for some reason the properties start with a lower case character\n                    if (!property.startsWith(\"@\")) entryPoints[property.toLowerCase()] = json[property];\n                }\n\n                // read the link header of the api response\n                //                const utils = require(\"./utils\");\n                const links = utils.parseLinkHeader(this.getResponseHeader(\"link\"));\n\n                // get the hydra apiDocumentation url\n                const apiDocUrl = links[\"http://www.w3.org/ns/hydra/core#apiDocumentation\"];\n\n                if (apiDocUrl !== undefined) {\n                    // load the hydra apiDocumentation\n                    const docXhr = new XMLHttpRequest();\n                    docXhr.open(\"GET\", apiDocUrl, true);\n                    docXhr.setRequestHeader(\"Content-Type\", \"application/json\");\n                    docXhr.onreadystatechange = function () {\n                        if (docXhr.readyState !== 4) {\n                            return;\n                        }\n\n                        if (docXhr.status === 200) {\n                            JSONLD.gatherEntities(docXhr, apiUrl, entryPoints);\n                        } else {\n                            JSONLD.executeFailureFunctions(apiUrl, i18n.t('jsonld.api-documentation-server', {apiUrl: apiDocUrl}));\n                        }\n                    };\n\n                    docXhr.send();\n                } else {\n                    JSONLD.executeFailureFunctions(apiUrl, i18n.t('jsonld.error-hydra-documentation-url-not-set', {apiUrl: apiUrl}));\n                }\n            } else {\n                JSONLD.executeFailureFunctions(apiUrl, i18n.t('jsonld.error-api-server', {apiUrl: apiUrl}));\n            }\n        };\n\n        xhr.send();\n    }\n\n    /**\n     * Gather the entities\n     *\n     * @param docXhr\n     * @param apiUrl\n     * @param entryPoints\n     */\n    static gatherEntities(docXhr, apiUrl, entryPoints) {\n        const json = JSON.parse(docXhr.responseText);\n        const supportedClasses = json[\"hydra:supportedClass\"];\n\n        let entities = {};\n        const baseUrl = utils.parseBaseUrl(apiUrl);\n\n        // gather the entities\n        supportedClasses.forEach(function (classData) {\n            // add entry point url\n            const entityName = classData[\"hydra:title\"];\n            let entryPoint = entryPoints[entityName.toLowerCase()];\n            if (entryPoint !== undefined && !entryPoint.startsWith(\"http\")) entryPoint = baseUrl + entryPoint;\n            classData[\"@entryPoint\"] = entryPoint;\n\n            entities[entityName] = classData;\n        });\n\n        const instance = new JSONLD(baseUrl, entities);\n        instances[apiUrl] = instance;\n\n        // return the initialized JSONLD object\n        for (const fnc of successFunctions[apiUrl]) if (typeof fnc == 'function') fnc(instance);\n        successFunctions[apiUrl] = [];\n    }\n\n    /**\n     * Execute failure functions and send general notification\n     *\n     * @param apiUrl\n     * @param message\n     */\n    static executeFailureFunctions(apiUrl, message = \"\") {\n        for (const fnc of failureFunctions[apiUrl]) if (typeof fnc == 'function') fnc();\n        failureFunctions[apiUrl] = [];\n\n        if (message !== \"\") {\n            notify({\n                \"summary\": i18n.t('error.summary'),\n                \"body\": message,\n                \"type\": \"danger\",\n            });\n        }\n    }\n\n    static getInstance(apiUrl) {\n        return instances[apiUrl];\n    }\n\n    getEntityForIdentifier(identifier) {\n        let entityName = this.getEntityNameForIdentifier(identifier);\n        return this.getEntityForEntityName(entityName);\n    }\n\n    getEntityForEntityName(entityName) {\n        return this.entities[entityName];\n    }\n\n    getApiUrlForIdentifier(identifier) {\n        const entity = this.getEntityForIdentifier(identifier);\n\n        if (entity === undefined || entity[\"@entryPoint\"] === undefined) {\n            throw new Error(`Entity with identifier \"${identifier}\" not found!`);\n        }\n\n        return entity[\"@entryPoint\"];\n    }\n\n    getApiUrlForEntityName(entityName) {\n        const entity = this.getEntityForEntityName(entityName);\n\n        if (entity === undefined || entity[\"@entryPoint\"] === undefined) {\n            throw new Error(`Entity \"${entityName}\" not found!`);\n        }\n\n        return entity[\"@entryPoint\"];\n    }\n\n    getEntityNameForIdentifier(identifier) {\n        return this.idToEntityNameMatchList[identifier];\n    }\n\n    getApiIdentifierList() {\n        let keys = [];\n        for (const property in this.idToEntityNameMatchList) {\n            keys.push(property);\n        }\n\n        return keys;\n    }\n\n    /**\n     * Expands a member of a list to a object with schema.org properties\n     *\n     * @param member\n     * @param [context]\n     */\n    expandMember(member, context) {\n        if (context === undefined) {\n            context = member[\"@context\"];\n        }\n\n        let result = {\"@id\": member[\"@id\"]};\n        for (const key of Object.keys(context)) {\n            const value = context[key];\n            if (member[key] !== undefined)\n                result[value] = member[key];\n        }\n\n        return result;\n    }\n\n    /**\n     * Compacts an expanded member of a list to a object with local properties\n     *\n     * @param member\n     * @param localContext\n     */\n    compactMember(member, localContext) {\n        let result = {};\n\n        for (const property in localContext) {\n            const value = member[localContext[property]];\n\n            if (value !== undefined) {\n                result[property] = value;\n            }\n        }\n\n        return result;\n    }\n\n    /**\n     * Transforms hydra members to a local context\n     *\n     * @param data\n     * @param localContext\n     * @returns {Array} An array of transformed objects\n     */\n    transformMembers(data, localContext) {\n        const members = data['hydra:member'];\n\n        if (members === undefined || members.length === 0) {\n            return [];\n        }\n\n        const otherContext = data['@context'];\n        let results = [];\n        let that = this;\n\n        members.forEach(function (member) {\n            results.push(that.compactMember(that.expandMember(member, otherContext), localContext));\n        });\n\n        return results;\n    }\n}\n","/**\n * @author Toru Nagashima <https://github.com/mysticatea>\n * @copyright 2015 Toru Nagashima. All rights reserved.\n * See LICENSE file in root directory for full license.\n */\n/**\n * @typedef {object} PrivateData\n * @property {EventTarget} eventTarget The event target.\n * @property {{type:string}} event The original event object.\n * @property {number} eventPhase The current event phase.\n * @property {EventTarget|null} currentTarget The current event target.\n * @property {boolean} canceled The flag to prevent default.\n * @property {boolean} stopped The flag to stop propagation.\n * @property {boolean} immediateStopped The flag to stop propagation immediately.\n * @property {Function|null} passiveListener The listener if the current listener is passive. Otherwise this is null.\n * @property {number} timeStamp The unix time.\n * @private\n */\n\n/**\n * Private data for event wrappers.\n * @type {WeakMap<Event, PrivateData>}\n * @private\n */\nconst privateData = new WeakMap();\n\n/**\n * Cache for wrapper classes.\n * @type {WeakMap<Object, Function>}\n * @private\n */\nconst wrappers = new WeakMap();\n\n/**\n * Get private data.\n * @param {Event} event The event object to get private data.\n * @returns {PrivateData} The private data of the event.\n * @private\n */\nfunction pd(event) {\n    const retv = privateData.get(event);\n    console.assert(\n        retv != null,\n        \"'this' is expected an Event object, but got\",\n        event\n    );\n    return retv\n}\n\n/**\n * https://dom.spec.whatwg.org/#set-the-canceled-flag\n * @param data {PrivateData} private data.\n */\nfunction setCancelFlag(data) {\n    if (data.passiveListener != null) {\n        if (\n            typeof console !== \"undefined\" &&\n            typeof console.error === \"function\"\n        ) {\n            console.error(\n                \"Unable to preventDefault inside passive event listener invocation.\",\n                data.passiveListener\n            );\n        }\n        return\n    }\n    if (!data.event.cancelable) {\n        return\n    }\n\n    data.canceled = true;\n    if (typeof data.event.preventDefault === \"function\") {\n        data.event.preventDefault();\n    }\n}\n\n/**\n * @see https://dom.spec.whatwg.org/#interface-event\n * @private\n */\n/**\n * The event wrapper.\n * @constructor\n * @param {EventTarget} eventTarget The event target of this dispatching.\n * @param {Event|{type:string}} event The original event to wrap.\n */\nfunction Event(eventTarget, event) {\n    privateData.set(this, {\n        eventTarget,\n        event,\n        eventPhase: 2,\n        currentTarget: eventTarget,\n        canceled: false,\n        stopped: false,\n        immediateStopped: false,\n        passiveListener: null,\n        timeStamp: event.timeStamp || Date.now(),\n    });\n\n    // https://heycam.github.io/webidl/#Unforgeable\n    Object.defineProperty(this, \"isTrusted\", { value: false, enumerable: true });\n\n    // Define accessors\n    const keys = Object.keys(event);\n    for (let i = 0; i < keys.length; ++i) {\n        const key = keys[i];\n        if (!(key in this)) {\n            Object.defineProperty(this, key, defineRedirectDescriptor(key));\n        }\n    }\n}\n\n// Should be enumerable, but class methods are not enumerable.\nEvent.prototype = {\n    /**\n     * The type of this event.\n     * @type {string}\n     */\n    get type() {\n        return pd(this).event.type\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     */\n    get target() {\n        return pd(this).eventTarget\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     */\n    get currentTarget() {\n        return pd(this).currentTarget\n    },\n\n    /**\n     * @returns {EventTarget[]} The composed path of this event.\n     */\n    composedPath() {\n        const currentTarget = pd(this).currentTarget;\n        if (currentTarget == null) {\n            return []\n        }\n        return [currentTarget]\n    },\n\n    /**\n     * Constant of NONE.\n     * @type {number}\n     */\n    get NONE() {\n        return 0\n    },\n\n    /**\n     * Constant of CAPTURING_PHASE.\n     * @type {number}\n     */\n    get CAPTURING_PHASE() {\n        return 1\n    },\n\n    /**\n     * Constant of AT_TARGET.\n     * @type {number}\n     */\n    get AT_TARGET() {\n        return 2\n    },\n\n    /**\n     * Constant of BUBBLING_PHASE.\n     * @type {number}\n     */\n    get BUBBLING_PHASE() {\n        return 3\n    },\n\n    /**\n     * The target of this event.\n     * @type {number}\n     */\n    get eventPhase() {\n        return pd(this).eventPhase\n    },\n\n    /**\n     * Stop event bubbling.\n     * @returns {void}\n     */\n    stopPropagation() {\n        const data = pd(this);\n\n        data.stopped = true;\n        if (typeof data.event.stopPropagation === \"function\") {\n            data.event.stopPropagation();\n        }\n    },\n\n    /**\n     * Stop event bubbling.\n     * @returns {void}\n     */\n    stopImmediatePropagation() {\n        const data = pd(this);\n\n        data.stopped = true;\n        data.immediateStopped = true;\n        if (typeof data.event.stopImmediatePropagation === \"function\") {\n            data.event.stopImmediatePropagation();\n        }\n    },\n\n    /**\n     * The flag to be bubbling.\n     * @type {boolean}\n     */\n    get bubbles() {\n        return Boolean(pd(this).event.bubbles)\n    },\n\n    /**\n     * The flag to be cancelable.\n     * @type {boolean}\n     */\n    get cancelable() {\n        return Boolean(pd(this).event.cancelable)\n    },\n\n    /**\n     * Cancel this event.\n     * @returns {void}\n     */\n    preventDefault() {\n        setCancelFlag(pd(this));\n    },\n\n    /**\n     * The flag to indicate cancellation state.\n     * @type {boolean}\n     */\n    get defaultPrevented() {\n        return pd(this).canceled\n    },\n\n    /**\n     * The flag to be composed.\n     * @type {boolean}\n     */\n    get composed() {\n        return Boolean(pd(this).event.composed)\n    },\n\n    /**\n     * The unix time of this event.\n     * @type {number}\n     */\n    get timeStamp() {\n        return pd(this).timeStamp\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     * @deprecated\n     */\n    get srcElement() {\n        return pd(this).eventTarget\n    },\n\n    /**\n     * The flag to stop event bubbling.\n     * @type {boolean}\n     * @deprecated\n     */\n    get cancelBubble() {\n        return pd(this).stopped\n    },\n    set cancelBubble(value) {\n        if (!value) {\n            return\n        }\n        const data = pd(this);\n\n        data.stopped = true;\n        if (typeof data.event.cancelBubble === \"boolean\") {\n            data.event.cancelBubble = true;\n        }\n    },\n\n    /**\n     * The flag to indicate cancellation state.\n     * @type {boolean}\n     * @deprecated\n     */\n    get returnValue() {\n        return !pd(this).canceled\n    },\n    set returnValue(value) {\n        if (!value) {\n            setCancelFlag(pd(this));\n        }\n    },\n\n    /**\n     * Initialize this event object. But do nothing under event dispatching.\n     * @param {string} type The event type.\n     * @param {boolean} [bubbles=false] The flag to be possible to bubble up.\n     * @param {boolean} [cancelable=false] The flag to be possible to cancel.\n     * @deprecated\n     */\n    initEvent() {\n        // Do nothing.\n    },\n};\n\n// `constructor` is not enumerable.\nObject.defineProperty(Event.prototype, \"constructor\", {\n    value: Event,\n    configurable: true,\n    writable: true,\n});\n\n// Ensure `event instanceof window.Event` is `true`.\nif (typeof window !== \"undefined\" && typeof window.Event !== \"undefined\") {\n    Object.setPrototypeOf(Event.prototype, window.Event.prototype);\n\n    // Make association for wrappers.\n    wrappers.set(window.Event.prototype, Event);\n}\n\n/**\n * Get the property descriptor to redirect a given property.\n * @param {string} key Property name to define property descriptor.\n * @returns {PropertyDescriptor} The property descriptor to redirect the property.\n * @private\n */\nfunction defineRedirectDescriptor(key) {\n    return {\n        get() {\n            return pd(this).event[key]\n        },\n        set(value) {\n            pd(this).event[key] = value;\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Get the property descriptor to call a given method property.\n * @param {string} key Property name to define property descriptor.\n * @returns {PropertyDescriptor} The property descriptor to call the method property.\n * @private\n */\nfunction defineCallDescriptor(key) {\n    return {\n        value() {\n            const event = pd(this).event;\n            return event[key].apply(event, arguments)\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Define new wrapper class.\n * @param {Function} BaseEvent The base wrapper class.\n * @param {Object} proto The prototype of the original event.\n * @returns {Function} The defined wrapper class.\n * @private\n */\nfunction defineWrapper(BaseEvent, proto) {\n    const keys = Object.keys(proto);\n    if (keys.length === 0) {\n        return BaseEvent\n    }\n\n    /** CustomEvent */\n    function CustomEvent(eventTarget, event) {\n        BaseEvent.call(this, eventTarget, event);\n    }\n\n    CustomEvent.prototype = Object.create(BaseEvent.prototype, {\n        constructor: { value: CustomEvent, configurable: true, writable: true },\n    });\n\n    // Define accessors.\n    for (let i = 0; i < keys.length; ++i) {\n        const key = keys[i];\n        if (!(key in BaseEvent.prototype)) {\n            const descriptor = Object.getOwnPropertyDescriptor(proto, key);\n            const isFunc = typeof descriptor.value === \"function\";\n            Object.defineProperty(\n                CustomEvent.prototype,\n                key,\n                isFunc\n                    ? defineCallDescriptor(key)\n                    : defineRedirectDescriptor(key)\n            );\n        }\n    }\n\n    return CustomEvent\n}\n\n/**\n * Get the wrapper class of a given prototype.\n * @param {Object} proto The prototype of the original event to get its wrapper.\n * @returns {Function} The wrapper class.\n * @private\n */\nfunction getWrapper(proto) {\n    if (proto == null || proto === Object.prototype) {\n        return Event\n    }\n\n    let wrapper = wrappers.get(proto);\n    if (wrapper == null) {\n        wrapper = defineWrapper(getWrapper(Object.getPrototypeOf(proto)), proto);\n        wrappers.set(proto, wrapper);\n    }\n    return wrapper\n}\n\n/**\n * Wrap a given event to management a dispatching.\n * @param {EventTarget} eventTarget The event target of this dispatching.\n * @param {Object} event The event to wrap.\n * @returns {Event} The wrapper instance.\n * @private\n */\nfunction wrapEvent(eventTarget, event) {\n    const Wrapper = getWrapper(Object.getPrototypeOf(event));\n    return new Wrapper(eventTarget, event)\n}\n\n/**\n * Get the immediateStopped flag of a given event.\n * @param {Event} event The event to get.\n * @returns {boolean} The flag to stop propagation immediately.\n * @private\n */\nfunction isStopped(event) {\n    return pd(event).immediateStopped\n}\n\n/**\n * Set the current event phase of a given event.\n * @param {Event} event The event to set current target.\n * @param {number} eventPhase New event phase.\n * @returns {void}\n * @private\n */\nfunction setEventPhase(event, eventPhase) {\n    pd(event).eventPhase = eventPhase;\n}\n\n/**\n * Set the current target of a given event.\n * @param {Event} event The event to set current target.\n * @param {EventTarget|null} currentTarget New current target.\n * @returns {void}\n * @private\n */\nfunction setCurrentTarget(event, currentTarget) {\n    pd(event).currentTarget = currentTarget;\n}\n\n/**\n * Set a passive listener of a given event.\n * @param {Event} event The event to set current target.\n * @param {Function|null} passiveListener New passive listener.\n * @returns {void}\n * @private\n */\nfunction setPassiveListener(event, passiveListener) {\n    pd(event).passiveListener = passiveListener;\n}\n\n/**\n * @typedef {object} ListenerNode\n * @property {Function} listener\n * @property {1|2|3} listenerType\n * @property {boolean} passive\n * @property {boolean} once\n * @property {ListenerNode|null} next\n * @private\n */\n\n/**\n * @type {WeakMap<object, Map<string, ListenerNode>>}\n * @private\n */\nconst listenersMap = new WeakMap();\n\n// Listener types\nconst CAPTURE = 1;\nconst BUBBLE = 2;\nconst ATTRIBUTE = 3;\n\n/**\n * Check whether a given value is an object or not.\n * @param {any} x The value to check.\n * @returns {boolean} `true` if the value is an object.\n */\nfunction isObject(x) {\n    return x !== null && typeof x === \"object\" //eslint-disable-line no-restricted-syntax\n}\n\n/**\n * Get listeners.\n * @param {EventTarget} eventTarget The event target to get.\n * @returns {Map<string, ListenerNode>} The listeners.\n * @private\n */\nfunction getListeners(eventTarget) {\n    const listeners = listenersMap.get(eventTarget);\n    if (listeners == null) {\n        throw new TypeError(\n            \"'this' is expected an EventTarget object, but got another value.\"\n        )\n    }\n    return listeners\n}\n\n/**\n * Get the property descriptor for the event attribute of a given event.\n * @param {string} eventName The event name to get property descriptor.\n * @returns {PropertyDescriptor} The property descriptor.\n * @private\n */\nfunction defineEventAttributeDescriptor(eventName) {\n    return {\n        get() {\n            const listeners = getListeners(this);\n            let node = listeners.get(eventName);\n            while (node != null) {\n                if (node.listenerType === ATTRIBUTE) {\n                    return node.listener\n                }\n                node = node.next;\n            }\n            return null\n        },\n\n        set(listener) {\n            if (typeof listener !== \"function\" && !isObject(listener)) {\n                listener = null; // eslint-disable-line no-param-reassign\n            }\n            const listeners = getListeners(this);\n\n            // Traverse to the tail while removing old value.\n            let prev = null;\n            let node = listeners.get(eventName);\n            while (node != null) {\n                if (node.listenerType === ATTRIBUTE) {\n                    // Remove old value.\n                    if (prev !== null) {\n                        prev.next = node.next;\n                    } else if (node.next !== null) {\n                        listeners.set(eventName, node.next);\n                    } else {\n                        listeners.delete(eventName);\n                    }\n                } else {\n                    prev = node;\n                }\n\n                node = node.next;\n            }\n\n            // Add new value.\n            if (listener !== null) {\n                const newNode = {\n                    listener,\n                    listenerType: ATTRIBUTE,\n                    passive: false,\n                    once: false,\n                    next: null,\n                };\n                if (prev === null) {\n                    listeners.set(eventName, newNode);\n                } else {\n                    prev.next = newNode;\n                }\n            }\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Define an event attribute (e.g. `eventTarget.onclick`).\n * @param {Object} eventTargetPrototype The event target prototype to define an event attrbite.\n * @param {string} eventName The event name to define.\n * @returns {void}\n */\nfunction defineEventAttribute(eventTargetPrototype, eventName) {\n    Object.defineProperty(\n        eventTargetPrototype,\n        `on${eventName}`,\n        defineEventAttributeDescriptor(eventName)\n    );\n}\n\n/**\n * Define a custom EventTarget with event attributes.\n * @param {string[]} eventNames Event names for event attributes.\n * @returns {EventTarget} The custom EventTarget.\n * @private\n */\nfunction defineCustomEventTarget(eventNames) {\n    /** CustomEventTarget */\n    function CustomEventTarget() {\n        EventTarget.call(this);\n    }\n\n    CustomEventTarget.prototype = Object.create(EventTarget.prototype, {\n        constructor: {\n            value: CustomEventTarget,\n            configurable: true,\n            writable: true,\n        },\n    });\n\n    for (let i = 0; i < eventNames.length; ++i) {\n        defineEventAttribute(CustomEventTarget.prototype, eventNames[i]);\n    }\n\n    return CustomEventTarget\n}\n\n/**\n * EventTarget.\n *\n * - This is constructor if no arguments.\n * - This is a function which returns a CustomEventTarget constructor if there are arguments.\n *\n * For example:\n *\n *     class A extends EventTarget {}\n *     class B extends EventTarget(\"message\") {}\n *     class C extends EventTarget(\"message\", \"error\") {}\n *     class D extends EventTarget([\"message\", \"error\"]) {}\n */\nfunction EventTarget() {\n    /*eslint-disable consistent-return */\n    if (this instanceof EventTarget) {\n        listenersMap.set(this, new Map());\n        return\n    }\n    if (arguments.length === 1 && Array.isArray(arguments[0])) {\n        return defineCustomEventTarget(arguments[0])\n    }\n    if (arguments.length > 0) {\n        const types = new Array(arguments.length);\n        for (let i = 0; i < arguments.length; ++i) {\n            types[i] = arguments[i];\n        }\n        return defineCustomEventTarget(types)\n    }\n    throw new TypeError(\"Cannot call a class as a function\")\n    /*eslint-enable consistent-return */\n}\n\n// Should be enumerable, but class methods are not enumerable.\nEventTarget.prototype = {\n    /**\n     * Add a given listener to this event target.\n     * @param {string} eventName The event name to add.\n     * @param {Function} listener The listener to add.\n     * @param {boolean|{capture?:boolean,passive?:boolean,once?:boolean}} [options] The options for this listener.\n     * @returns {void}\n     */\n    addEventListener(eventName, listener, options) {\n        if (listener == null) {\n            return\n        }\n        if (typeof listener !== \"function\" && !isObject(listener)) {\n            throw new TypeError(\"'listener' should be a function or an object.\")\n        }\n\n        const listeners = getListeners(this);\n        const optionsIsObj = isObject(options);\n        const capture = optionsIsObj\n            ? Boolean(options.capture)\n            : Boolean(options);\n        const listenerType = capture ? CAPTURE : BUBBLE;\n        const newNode = {\n            listener,\n            listenerType,\n            passive: optionsIsObj && Boolean(options.passive),\n            once: optionsIsObj && Boolean(options.once),\n            next: null,\n        };\n\n        // Set it as the first node if the first node is null.\n        let node = listeners.get(eventName);\n        if (node === undefined) {\n            listeners.set(eventName, newNode);\n            return\n        }\n\n        // Traverse to the tail while checking duplication..\n        let prev = null;\n        while (node != null) {\n            if (\n                node.listener === listener &&\n                node.listenerType === listenerType\n            ) {\n                // Should ignore duplication.\n                return\n            }\n            prev = node;\n            node = node.next;\n        }\n\n        // Add it.\n        prev.next = newNode;\n    },\n\n    /**\n     * Remove a given listener from this event target.\n     * @param {string} eventName The event name to remove.\n     * @param {Function} listener The listener to remove.\n     * @param {boolean|{capture?:boolean,passive?:boolean,once?:boolean}} [options] The options for this listener.\n     * @returns {void}\n     */\n    removeEventListener(eventName, listener, options) {\n        if (listener == null) {\n            return\n        }\n\n        const listeners = getListeners(this);\n        const capture = isObject(options)\n            ? Boolean(options.capture)\n            : Boolean(options);\n        const listenerType = capture ? CAPTURE : BUBBLE;\n\n        let prev = null;\n        let node = listeners.get(eventName);\n        while (node != null) {\n            if (\n                node.listener === listener &&\n                node.listenerType === listenerType\n            ) {\n                if (prev !== null) {\n                    prev.next = node.next;\n                } else if (node.next !== null) {\n                    listeners.set(eventName, node.next);\n                } else {\n                    listeners.delete(eventName);\n                }\n                return\n            }\n\n            prev = node;\n            node = node.next;\n        }\n    },\n\n    /**\n     * Dispatch a given event.\n     * @param {Event|{type:string}} event The event to dispatch.\n     * @returns {boolean} `false` if canceled.\n     */\n    dispatchEvent(event) {\n        if (event == null || typeof event.type !== \"string\") {\n            throw new TypeError('\"event.type\" should be a string.')\n        }\n\n        // If listeners aren't registered, terminate.\n        const listeners = getListeners(this);\n        const eventName = event.type;\n        let node = listeners.get(eventName);\n        if (node == null) {\n            return true\n        }\n\n        // Since we cannot rewrite several properties, so wrap object.\n        const wrappedEvent = wrapEvent(this, event);\n\n        // This doesn't process capturing phase and bubbling phase.\n        // This isn't participating in a tree.\n        let prev = null;\n        while (node != null) {\n            // Remove this listener if it's once\n            if (node.once) {\n                if (prev !== null) {\n                    prev.next = node.next;\n                } else if (node.next !== null) {\n                    listeners.set(eventName, node.next);\n                } else {\n                    listeners.delete(eventName);\n                }\n            } else {\n                prev = node;\n            }\n\n            // Call this listener\n            setPassiveListener(\n                wrappedEvent,\n                node.passive ? node.listener : null\n            );\n            if (typeof node.listener === \"function\") {\n                try {\n                    node.listener.call(this, wrappedEvent);\n                } catch (err) {\n                    if (\n                        typeof console !== \"undefined\" &&\n                        typeof console.error === \"function\"\n                    ) {\n                        console.error(err);\n                    }\n                }\n            } else if (\n                node.listenerType !== ATTRIBUTE &&\n                typeof node.listener.handleEvent === \"function\"\n            ) {\n                node.listener.handleEvent(wrappedEvent);\n            }\n\n            // Break if `event.stopImmediatePropagation` was called.\n            if (isStopped(wrappedEvent)) {\n                break\n            }\n\n            node = node.next;\n        }\n        setPassiveListener(wrappedEvent, null);\n        setEventPhase(wrappedEvent, 0);\n        setCurrentTarget(wrappedEvent, null);\n\n        return !wrappedEvent.defaultPrevented\n    },\n};\n\n// `constructor` is not enumerable.\nObject.defineProperty(EventTarget.prototype, \"constructor\", {\n    value: EventTarget,\n    configurable: true,\n    writable: true,\n});\n\n// Ensure `eventTarget instanceof window.EventTarget` is `true`.\nif (\n    typeof window !== \"undefined\" &&\n    typeof window.EventTarget !== \"undefined\"\n) {\n    Object.setPrototypeOf(EventTarget.prototype, window.EventTarget.prototype);\n}\n\nexport default EventTarget;\nexport { defineEventAttribute, EventTarget };\n//# sourceMappingURL=event-target-shim.mjs.map\n","import {EventTarget} from \"event-target-shim\";  // Because EventTarget() doesn't exist on Safari\n\n\n/**\n * Imports the keycloak JS API as if it was a module.\n *\n * @param baseUrl {string}\n */\nasync function importKeycloak(baseUrl) {\n    const keycloakSrc = baseUrl + '/js/keycloak.min.js';\n    // Importing will write it to window so we take it from there\n    await import(keycloakSrc);\n    if (importKeycloak._keycloakMod !== undefined)\n        return importKeycloak._keycloakMod;\n    importKeycloak._keycloakMod = window.Keycloak;\n    delete window.Keycloak;\n    return importKeycloak._keycloakMod;\n}\n\n\nconst promiseTimeout = function(ms, promise) {\n    let timeout = new Promise((resolve, reject) => {\n      let id = setTimeout(() => {\n        clearTimeout(id);\n        reject('Timed out in '+ ms + 'ms.');\n      }, ms);\n    });\n\n    return Promise.race([\n      promise,\n      timeout\n    ]);\n};\n\n\n/**\n * Returns a URL for a relative path or URL\n *\n * @param {string} urlOrPath\n */\nconst ensureURL = function(urlOrPath) {\n    try {\n        return new URL(urlOrPath).href;\n    } catch (e) {\n        return new URL(urlOrPath, window.location.href).href;\n    }\n};\n\n\n/**\n * Wraps the keycloak API to support async/await, adds auto token refreshing and consolidates all\n * events into one native \"changed\" event\n * \n * The \"changed\" event has the real keycloak instance as \"detail\"\n */\nexport class KeycloakWrapper extends EventTarget {\n\n    constructor(baseURL, realm, clientId, silentCheckSsoUri, idpHint) {\n        super();\n\n        this._baseURL = baseURL;\n        this._realm = realm;\n        this._clientId = clientId;\n        this._keycloak = null;\n        this._initDone = false;\n        this._silentCheckSsoUri = silentCheckSsoUri;\n        this._idpHint = idpHint;\n        this._checkId = null;\n\n        /* Minimum validity of the token in seconds */\n        this.MIN_VALIDITY = 20;\n\n        /* Interval at which the token validity is checked, in seconds */\n        this.CHECK_INTERVAL = 10;\n\n        /* Enables extra debug logging */\n        this.DEBUG = false;\n\n        this._onVisibilityChanged = this._onVisibilityChanged.bind(this);\n        document.addEventListener(\"visibilitychange\", this._onVisibilityChanged);\n    }\n\n    /**\n     * This needs to be called or the instance will leak;\n     */\n    close() {\n        document.removeEventListener(\"visibilitychange\", this._onVisibilityChanged);\n    }\n\n    _onVisibilityChanged() {\n        let isVisible = (document.visibilityState === 'visible');\n        if (isVisible && this._keycloak.authenticated) {\n            this._checkTokeHasExpired();\n        }\n    }\n\n    _onChanged() {\n        const event = new CustomEvent(\"changed\", {\n            detail: this._keycloak,\n            bubbles: true,\n            composed: true\n        });\n        this.dispatchEvent(event);\n    }\n\n    _onReady(authenticated) {\n        // Avoid emitting changed when nothing has changed on init()\n        if (authenticated)\n            this._onChanged();\n    }\n\n    async _onTokenExpired() {\n        console.log('Token has expired');\n        let refreshed = false;\n\n        try {\n            // -1 means force a refresh\n            refreshed = await this._keycloak.updateToken(-1);\n        } catch (error) {\n            console.log('Failed to refresh the token', error);\n            return;\n        }\n\n        console.assert(refreshed, \"token should have been refreshed\");\n    }\n\n    async _checkTokeHasExpired() {\n        let refreshed;\n\n        let minValidity = this.MIN_VALIDITY + this.CHECK_INTERVAL;\n        if (this.DEBUG) {\n            console.log(`Updating token if not valid for at least ${minValidity}s`);\n        }\n        try {\n            refreshed = await this._keycloak.updateToken(minValidity);\n        } catch (error) {\n            console.log('Failed to refresh the token', error);\n        }\n\n        if (this.DEBUG && refreshed)\n            console.log(\"token has been refreshed\");\n    }\n\n    async _onAuthSuccess() {\n        // We check every once in a while if the token is still valid and\n        // and refresh it if needed.\n        if (this._checkId !== null) {\n            clearInterval(this._checkId);\n            this._checkId = null;\n        }\n        this._checkId = setInterval(this._checkTokeHasExpired.bind(this), this.CHECK_INTERVAL * 1000);\n\n        this._onChanged();\n    }\n\n    async _onAuthLogout() {\n        if (this._checkId !== null) {\n            clearInterval(this._checkId);\n            this._checkId = null;\n        }\n\n        this._onChanged();\n    }\n\n    async _ensureInstance() {\n        if (this._keycloak !== null)\n            return;\n\n        const Keycloak = await importKeycloak(this._baseURL);\n\n        this._keycloak = Keycloak({\n            url: this._baseURL,\n            realm: this._realm,\n            clientId: this._clientId,\n        });\n\n        this._keycloak.onTokenExpired = this._onTokenExpired.bind(this);\n        this._keycloak.onAuthRefreshSuccess = this._onChanged.bind(this);\n        this._keycloak.onAuthRefreshError = this._onChanged.bind(this);\n        this._keycloak.onAuthLogout = this._onAuthLogout.bind(this);\n        this._keycloak.onAuthSuccess = this._onAuthSuccess.bind(this);\n        this._keycloak.onAuthError = this._onChanged.bind(this);\n        this._keycloak.onReady = this._onReady.bind(this);\n    }\n\n    async _keycloakInit(options) {\n        // https://gitlab.tugraz.at/dbp/apps/library/issues/41\n        // retry the keycloak init in case it fails, maybe it helps :/\n        try {\n            return await this._keycloak.init(options);\n        } catch (e) {\n            return await this._keycloak.init(options);\n        }\n    }\n\n    async _ensureInit() {\n        await this._ensureInstance();\n        if (this._initDone)\n            return;\n        this._initDone = true;\n\n        const options = {\n            promiseType: 'native',\n            pkceMethod: 'S256',\n        };\n\n        if (this.DEBUG) {\n            options['enableLogging'] = true;\n        }\n\n        if (this._silentCheckSsoUri) {\n\n            options['onLoad'] = 'check-sso';\n            options['silentCheckSsoRedirectUri'] = ensureURL(this._silentCheckSsoUri);\n\n            // When silent-sso-check is active but the iframe doesn't load/work we will\n            // never return here, so add a timeout and emit a signal so the app can continue\n            await promiseTimeout(5000, this._keycloakInit(options)).catch(() => {\n                console.log('Login timed out');\n                this._onChanged();\n            });\n        } else {\n            await this._keycloakInit(options);\n        }\n\n    }\n\n    /**\n     * If this returns true you need to call login() at one point to finish the login process.\n     */\n    isLoggingIn() {\n        const href = window.location.href;\n        return (href.search('[&#]state=') >= 0 && href.search('[&#]session_state=') >= 0);\n    }\n\n    /**\n     * Logs the user in. Might lead to a site refresh or the user needing to authenticate.\n     *\n     * @param {object} options\n     * @param {string} [options.lang] - The locale to use on the keycloak login page\n     */\n    async login(options) {\n        await this._ensureInit();\n\n        options = options || {};\n        const language = options['lang'] || 'en';\n        const scope = options['scope'] || '';\n\n        if (!this._keycloak.authenticated) {\n            await this._keycloak.login({\n                kcLocale: language,  // Keycloak < 9.0\n                locale: language,\n                scope: scope,\n                idpHint: this._idpHint,\n            });\n        }\n    }\n\n    /**\n     * Logs the user in if it is possible without leaving the page or the user needing to authenticate again.\n     */\n    async tryLogin() {\n        await this._ensureInit();\n    }\n\n    /**\n     * Logs the user out locally, but not with keycloak. Login will instantly log the user back in without\n     * requiring a re-auth.\n     */\n    async localLogout() {\n        this._keycloak.clearToken();\n    }\n\n    /**\n     * Log the user out from keycloak.\n     */\n    async logout() {\n        await this._ensureInit();\n        this._keycloak.logout();\n    }\n}","export const LoginStatus = Object.freeze({\n    UNKNOWN: 'unknown',\n    LOGGING_IN: 'logging-in',\n    LOGGED_IN: 'logged-in',\n    LOGGING_OUT: 'logging-out',\n    LOGGED_OUT: 'logged-out',\n});\n","import {i18n} from './i18n.js';\nimport JSONLD from '@dbp-toolkit/common/jsonld';\nimport * as commonUtils from '@dbp-toolkit/common/utils';\nimport {EventBus} from '@dbp-toolkit/common';\nimport  {KeycloakWrapper} from './keycloak.js';\nimport {LitElement} from \"lit-element\";\nimport {LoginStatus} from './util.js';\n\n\n/**\n * Keycloak auth web component\n * https://www.keycloak.org/docs/latest/securing_apps/index.html#_javascript_adapter\n *\n * Dispatches an event `dbp-auth-init` and sets some global variables:\n *   window.DBPAuthSubject: Keycloak username\n *   window.DBPAuthToken: Keycloak token to send with your requests\n *   window.DBPAuthTokenParsed: Keycloak token content\n *   window.DBPUserFullName: Full name of the user\n *   window.DBPPersonId: Person identifier of the user\n *   window.DBPPerson: Person json object of the user (optional, enable by setting the `load-person` attribute,\n *                     which will dispatch a `dbp-auth-person-init` event when loaded)\n */\nexport class AuthKeycloak extends LitElement {\n    constructor() {\n        super();\n        this.lang = 'de';\n        this.forceLogin = false;\n        this.loadPerson = false;\n        this.token = \"\";\n        this.tokenParsed = null;\n        this.subject = \"\";\n        this.name = \"\";\n        this.personId = \"\";\n        this.tryLogin = false;\n        this.person = null;\n        this.entryPointUrl = commonUtils.getAPiUrl();\n        this._loginStatus = LoginStatus.UNKNOWN;\n\n        // Keycloak config\n        this.keycloakUrl = null;\n        this.realm = null;\n        this.clientId = null;\n        this.silentCheckSsoRedirectUri = null;\n        this.scope = null;\n        this.idpHint = '';\n\n        // Create the events\n        this.initEvent = new CustomEvent(\"dbp-auth-init\", { \"detail\": \"KeyCloak init event\", bubbles: true, composed: true });\n        this.personInitEvent = new CustomEvent(\"dbp-auth-person-init\", { \"detail\": \"KeyCloak person init event\", bubbles: true, composed: true });\n        this.keycloakDataUpdateEvent = new CustomEvent(\"dbp-auth-keycloak-data-update\", { \"detail\": \"KeyCloak data was updated\", bubbles: true, composed: true });\n\n        this._onKCChanged = this._onKCChanged.bind(this);\n    }\n\n    update(changedProperties) {\n        changedProperties.forEach((oldValue, propName) => {\n            if (propName === \"lang\") {\n                i18n.changeLanguage(this.lang);\n            }\n        });\n\n        super.update(changedProperties);\n    }\n\n    _onKCChanged(event) {\n        const kc = event.detail;\n        let newPerson = false;\n\n        if (kc.authenticated) {\n            let tokenChanged = (this.token !== kc.token);\n            this.tokenParsed = kc.tokenParsed;\n            this.name = kc.idTokenParsed.name;\n            this.token = kc.token;\n\n            this.subject = kc.subject;\n            const personId = kc.idTokenParsed.preferred_username;\n            if (personId !== this.personId) {\n                this.person = null;\n                newPerson = true;\n            }\n            this.personId = personId;\n\n            window.DBPAuthSubject = this.subject;\n            window.DBPAuthToken = this.token;\n            window.DBPAuthTokenParsed = this.tokenParsed;\n            window.DBPUserFullName = this.name;\n            window.DBPPersonId = this.personId;\n            window.DBPPerson = this.person;\n\n            this._setLoginStatus(LoginStatus.LOGGED_IN, tokenChanged || newPerson);\n        } else {\n            if (this._loginStatus === LoginStatus.LOGGED_IN) {\n                this._setLoginStatus(LoginStatus.LOGGING_OUT);\n            }\n            this.name = \"\";\n            this.token = \"\";\n            this.tokenParsed = null;\n            this.subject = \"\";\n            this.personId = \"\";\n            this.person = null;\n\n            window.DBPAuthSubject = this.subject;\n            window.DBPAuthToken = this.token;\n            window.DBPAuthTokenParsed = this.tokenParsed;\n            window.DBPUserFullName = this.name;\n            window.DBPPersonId = this.personId;\n            window.DBPPerson = this.person;\n\n            this._setLoginStatus(LoginStatus.LOGGED_OUT);\n        }\n\n        const that = this;\n\n        if (newPerson) {\n            this.dispatchEvent(this.initEvent);\n        }\n\n        if (newPerson && this.loadPerson) {\n            JSONLD.initialize(this.entryPointUrl, (jsonld) => {\n                // find the correct api url for the current person\n                // we are fetching the logged-in person directly to respect the REST philosophy\n                // see: https://github.com/api-platform/api-platform/issues/337\n                const apiUrl = jsonld.getApiUrlForEntityName(\"Person\") + '/' + that.personId;\n\n                fetch(apiUrl, {\n                    headers: {\n                        'Content-Type': 'application/ld+json',\n                        'Authorization': 'Bearer ' + that.token,\n                    },\n                })\n                .then(response => response.json())\n                .then((person) => {\n                    that.person = person;\n                    window.DBPPerson = person;\n                    that.dispatchEvent(that.personInitEvent);\n                    this._setLoginStatus(this._loginStatus, true);\n                });\n            }, {}, that.lang);\n        }\n\n        this.dispatchEvent(this.keycloakDataUpdateEvent);\n    }\n\n    _setLoginStatus(status, force) {\n        if (this._loginStatus === status && !force)\n            return;\n\n        this._loginStatus = status;\n\n        this._bus.publish('auth-update', {\n            status: this._loginStatus,\n            token: this.token,\n            name: this.name,\n            person: this.person,\n        }, {\n            retain: true,\n        });\n    }\n\n    static get properties() {\n        return {\n            lang: { type: String },\n            forceLogin: { type: Boolean, attribute: 'force-login' },\n            tryLogin: { type: Boolean, attribute: 'try-login' },\n            loadPerson: { type: Boolean, attribute: 'load-person' },\n            entryPointUrl: { type: String, attribute: 'entry-point-url' },\n            name: { type: String, attribute: false },\n            token: { type: String, attribute: false },\n            subject: { type: String, attribute: false },\n            personId: { type: String, attribute: false },\n            person: { type: Object, attribute: false },\n            _loginStatus: { type: String, attribute: false },\n            keycloakUrl: { type: String, attribute: 'url' },\n            realm: { type: String },\n            clientId: { type: String, attribute: 'client-id' },\n            silentCheckSsoRedirectUri: { type: String, attribute: 'silent-check-sso-redirect-uri' },\n            scope: { type: String },\n            idpHint: { type: String, attribute: 'idp-hint' },\n        };\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        if (!this.keycloakUrl)\n            throw Error(\"url not set\");\n        if (!this.realm)\n            throw Error(\"realm not set\");\n        if (!this.clientId)\n            throw Error(\"client-id not set\");\n\n        this._bus = new EventBus();\n        this._kcwrapper = new KeycloakWrapper(this.keycloakUrl, this.realm, this.clientId, this.silentCheckSsoRedirectUri, this.idpHint);\n        this._kcwrapper.addEventListener('changed', this._onKCChanged);\n\n        this._bus.subscribe('auth-login', () => {\n            this._kcwrapper.login({lang: this.lang, scope: this.scope || ''});\n        });\n\n        this._bus.subscribe('auth-logout', () => {\n            // Keycloak will redirect right away without emitting events, so we have\n            // to do this manually here\n            if (this._loginStatus === LoginStatus.LOGGED_IN) {\n                this._setLoginStatus(LoginStatus.LOGGING_OUT);\n            }\n            this._kcwrapper.logout();\n            // In case logout was aborted, for example with beforeunload,\n            // revert back to being logged in\n            if (this._loginStatus === LoginStatus.LOGGING_OUT) {\n                this._setLoginStatus(LoginStatus.LOGGED_IN);\n            }\n        });\n\n        const handleLogin = async () => {\n            if (this.forceLogin || this._kcwrapper.isLoggingIn()) {\n                this._setLoginStatus(LoginStatus.LOGGING_IN);\n                await this._kcwrapper.login({lang: this.lang, scope: this.scope || ''});\n            } else if (this.tryLogin) {\n                this._setLoginStatus(LoginStatus.LOGGING_IN);\n                await this._kcwrapper.tryLogin();\n                if (this._loginStatus === LoginStatus.LOGGING_IN)\n                    this._setLoginStatus(LoginStatus.LOGGED_OUT);\n            } else {\n                this._setLoginStatus(LoginStatus.LOGGED_OUT);\n            }\n        };\n\n        handleLogin();\n    }\n\n    disconnectedCallback() {\n        this._kcwrapper.close();\n        this._kcwrapper.removeEventListener('changed', this._onKCChanged);\n        this._bus.close();\n\n        super.disconnectedCallback();\n    }\n}","import {i18n} from './i18n.js';\nimport {html, css} from 'lit-element';\nimport {unsafeHTML} from 'lit-html/directives/unsafe-html.js';\nimport {ScopedElementsMixin} from '@open-wc/scoped-elements';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\nimport {LitElement} from \"lit-element\";\nimport {EventBus} from '@dbp-toolkit/common';\nimport {LoginStatus} from './util.js';\n\nlet logoutSVG = `\n<svg\n   viewBox=\"0 0 100 100\"\n   y=\"0px\"\n   x=\"0px\"\n   id=\"icon\"\n   role=\"img\"\n   version=\"1.1\">\n<g\n   id=\"g6\">\n  <path\n     d=\"m 20.749313,38.894934 -5.885859,6.967885 h 43.408213 c 1.839331,0 3.433418,1.741972 3.433418,4.064599 0,2.322628 -1.471465,4.064599 -3.433418,4.064599 H 14.863454 l 5.885859,6.967883 c 1.348843,1.596808 1.348843,4.064599 0,5.661406 -1.348843,1.596808 -3.433418,1.596808 -4.782261,0 L 1.9881356,49.927418 15.967052,33.378693 c 1.348843,-1.596806 3.433418,-1.596806 4.782261,0 1.348843,1.596807 1.348843,4.064599 0,5.516241 z\"\n     id=\"path2\"\n     style=\"stroke-width:1.33417916\"\n     inkscape:connector-curvature=\"0\" />\n  <path\n     style=\"stroke-width:0.67017764\"\n     d=\"M 61.663665,16.308792 C 48.158763,16.560171 35.913199,25.828579 30.896087,38.197464 34.816744,37.806184 40.033349,39.91491 41.470306,35.017776 50.594944,21.215302 72.517616,20.362655 82.800384,33.07637 93.497261,44.618596 90.228387,65.093356 76.499603,72.791214 64.104901,80.786232 45.895432,75.593227 39.470306,62.310745 35.613955,62.60637 27.974792,60.593775 32.925384,66.267776 41.232037,82.878292 64.023613,89.46919 79.876556,79.765823 96.140149,70.989504 102.10102,48.145494 91.970306,32.629104 85.705979,22.257901 73.793809,15.772382 61.663665,16.308792 Z\"\n     id=\"path4\"\n     inkscape:connector-curvature=\"0\" />\n</g>\n</svg>\n`;\n\nlet loginSVG = `\n<svg\n   viewBox=\"0 0 100 100\"\n   y=\"0px\"\n   x=\"0px\"\n   id=\"icon\"\n   role=\"img\"\n   version=\"1.1\">\n<g\n   id=\"g6\">\n    <path\n   style=\"stroke-width:1.33417916\"\n   id=\"path2\"\n   d=\"m 42.943908,38.894934 5.885859,6.967885 H 5.4215537 c -1.8393311,0 -3.4334181,1.741972 -3.4334181,4.064599 0,2.322628 1.4714649,4.064599 3.4334181,4.064599 H 48.829767 L 42.943908,60.9599 c -1.348843,1.596808 -1.348843,4.064599 0,5.661406 1.348843,1.596808 3.433418,1.596808 4.782261,0 L 61.705085,49.927418 47.726169,33.378693 c -1.348843,-1.596806 -3.433418,-1.596806 -4.782261,0 -1.348843,1.596807 -1.348843,4.064599 0,5.516241 z\" />\n    <path\n   id=\"path4\"\n   d=\"m 50,2.3007812 c -18.777325,0 -35.049449,10.9124408 -42.8261719,26.7246098 H 13.390625 C 20.672112,16.348362 34.336876,7.8007812 50,7.8007812 73.3,7.8007812 92.300781,26.7 92.300781,50 92.300781,73.3 73.3,92.300781 50,92.300781 c -15.673389,0 -29.345175,-8.60579 -36.623047,-21.326172 H 7.1640625 C 14.942553,86.8272 31.242598,97.800781 50.099609,97.800781 76.399609,97.800781 97.900391,76.4 97.900391,50 97.800391,23.7 76.3,2.3007812 50,2.3007812 Z\" />\n</g>\n</svg>\n`;\n\nexport class LoginButton extends ScopedElementsMixin(LitElement) {\n\n    constructor() {\n        super();\n        this.lang = 'de';\n        this._loginData = {};\n    }\n\n    static get scopedElements() {\n        return {\n        };\n    }\n\n    static get properties() {\n        return {\n            lang: { type: String },\n            _loginData: { type: Object, attribute: false },\n        };\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this._bus = new EventBus();\n        this._bus.subscribe('auth-update', (data) => {\n            this._loginData = data;\n        });\n    }\n\n    disconnectedCallback() {\n        this._bus.close();\n        super.disconnectedCallback();\n    }\n\n    _onLoginClicked(e) {\n        this._bus.publish('auth-login');\n        e.preventDefault();\n    }\n\n    _onLogoutClicked(e) {\n        this._bus.publish('auth-logout');\n        e.preventDefault();\n    }\n\n    update(changedProperties) {\n        changedProperties.forEach((oldValue, propName) => {\n            if (propName === \"lang\") {\n                i18n.changeLanguage(this.lang);\n            }\n        });\n\n        super.update(changedProperties);\n    }\n\n    static get styles() {\n        // language=css\n        return [\n            commonStyles.getThemeCSS(),\n            css`\n            :host {\n                display: inline-block;\n            }\n\n            a {\n                color: currentColor;\n                cursor: pointer;\n                text-decoration: none;\n            }\n\n            .login-box {\n                display: flex;\n                align-items: center;\n                padding: 0.3em 0.4em;\n                transition: background-color 0.15s, color 0.15s;\n            }\n\n            .login-box svg {\n                width: 1.1em;\n                height: 1.1em;\n                display: flex;\n            }\n\n            .login-box:hover svg path {\n                fill: var(--dbp-light);\n            }\n\n            .login-box:hover {\n                background-color: var(--dbp-dark);\n                color: var(--dbp-light);\n                cursor: pointer;\n                transition: none;\n            }\n\n            .login-box .label {\n                padding-left: 0.2em;\n            }\n            `\n        ];\n    }\n\n    render() {\n        if (this._loginData.status === LoginStatus.LOGGED_IN) {\n            return html`\n                <a href=\"#\" @click=\"${this._onLogoutClicked}\">\n                    <div class=\"login-box login-button\">\n                        <div class=\"icon\">${unsafeHTML(logoutSVG)}</div>\n                        <div class=\"label\">${i18n.t('logout')}</div>\n                    </div>\n                </a>\n            `;\n        } else {\n            return html`\n                <a href=\"#\" @click=\"${this._onLoginClicked}\">\n                    <div class=\"login-box login-button\">\n                        <div class=\"icon\">${unsafeHTML(loginSVG)}</div>\n                        <div class=\"label\">${i18n.t('login')}</div>\n                    </div>\n                </a>\n            `;\n        }\n    }\n}","import {createI18nInstance} from './i18n.js';\nimport {html, css} from 'lit-element';\nimport {unsafeHTML} from 'lit-html/directives/unsafe-html.js';\nimport {ScopedElementsMixin} from '@open-wc/scoped-elements';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\nimport {LitElement} from \"lit-element\";\nimport {Icon, EventBus} from '@dbp-toolkit/common';\n\n\nconst i18n = createI18nInstance();\n\nexport class AuthMenuButton extends ScopedElementsMixin(LitElement) {\n\n    constructor() {\n        super();\n        this.lang = 'de';\n        this.showImage = false;\n        this._loginData = {};\n\n        this.closeDropdown = this.closeDropdown.bind(this);\n        this.onWindowResize = this.onWindowResize.bind(this);\n    }\n\n    static get scopedElements() {\n        return {\n            'dbp-icon': Icon,\n        };\n    }\n\n    static get properties() {\n        return {\n            lang: { type: String },\n            showImage: { type: Boolean, attribute: 'show-image' },\n            _loginData: { type: Object, attribute: false },\n        };\n    }\n\n    onWindowResize() {\n        this.updateDropdownWidth();\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this._bus = new EventBus();\n        this._bus.subscribe('auth-update', (data) => {\n            this._loginData = data;\n        });\n\n        window.addEventListener('resize', this.onWindowResize);\n        document.addEventListener('click', this.closeDropdown);\n    }\n\n    disconnectedCallback() {\n        window.removeEventListener('resize', this.onWindowResize);\n        this._bus.close();\n        document.removeEventListener('click', this.closeDropdown);\n        super.disconnectedCallback();\n    }\n\n    /**\n     * Set the dropdown width to almost the width of the web component\n     * We need to set the width manually because a percent width is in relation to the viewport\n     */\n    updateDropdownWidth() {\n        const dropdown = this.shadowRoot.querySelector(\"div.dropdown-menu\");\n\n        if (!dropdown) {\n            return;\n        }\n\n        let viewportOffset = this.getBoundingClientRect();\n        let spaceToRIght = window.innerWidth - viewportOffset.left;\n        dropdown.setAttribute(\"style\", `width: ${spaceToRIght - 20}px`);\n    }\n\n    onLoginClicked(e) {\n        this._bus.publish('auth-login');\n        e.preventDefault();\n    }\n\n    onLogoutClicked(e) {\n        this._bus.publish('auth-logout');\n    }\n\n    update(changedProperties) {\n        changedProperties.forEach((oldValue, propName) => {\n            if (propName === \"lang\") {\n                i18n.changeLanguage(this.lang);\n            }\n        });\n\n        super.update(changedProperties);\n    }\n\n    static get styles() {\n        // language=css\n        return css`\n            ${commonStyles.getThemeCSS()}\n\n            :host {\n                display: inline-block;\n            }\n\n            a {\n                color: currentColor;\n                cursor: pointer;\n                text-decoration: none;\n            }\n\n            img {\n                border-width: var(--dbp-border-width);\n                border-color: var(--dbp-dark);\n                border-style: solid;\n            }\n\n            .dropdown.is-active .dropdown-menu, .dropdown.is-hoverable:hover .dropdown-menu {\n                display: block;\n            }\n\n            .dropdown-menu {\n                display: none;\n                min-width: 5em;\n                max-width: 25em;\n                position: absolute;\n                z-index: 20;\n                border: solid 1px black;\n                border-radius: var(--dbp-border-radius);\n                overflow: hidden;\n                background-color: white;\n            }\n\n            .dropdown-content {\n                background-color: white;\n                padding-bottom: 0.5rem;\n                padding-top: 0.5rem;\n            }\n\n            .dropdown-content img {\n                max-width: 120px;\n            }\n\n            .menu a {\n                /*padding: 0.3em;*/\n                font-weight: 400;\n                color: #000;\n                display: block;\n                text-decoration: none;\n            }\n\n            .menu a:hover {\n                color: #E4154B;\n            }\n\n            .menu a.selected { color: white; background-color: black; }\n\n            .dropdown-item {\n                color: #4a4a4a;\n                display: block;\n                font-size: 0.875rem;\n                line-height: 1.5;\n                padding: 0.375rem 1rem;\n                position: relative;\n            }\n\n              .dropdown, img.login {\n                cursor: pointer;\n            }\n\n            a.dropdown-item {\n                width: initial !important;\n            }\n\n            .main-button {\n                min-width: 150px;\n            }\n\n            .menu-icon {\n                height: 1em;\n                width: 1em;\n                vertical-align: -0.1rem;\n            }\n\n            .login-box svg {\n                width: 1.1em;\n                height: 1.1em;\n                display: flex;\n            }\n\n            .login-button {\n                padding: 0.3em 0.4em;\n                transition: background-color 0.15s, color 0.15s;\n            }\n\n            .login-button:hover {\n                background-color: var(--dbp-dark);\n                color: var(--dbp-light);\n                cursor: pointer;\n                transition: none;\n            }\n\n            .login-box {\n                display: flex;\n                align-items: center;\n            }\n\n            .login-box:hover svg path {\n                fill: var(--dbp-light);\n            }\n\n            .login-box .label {\n                padding-left: 0.2em;\n            }\n\n            .dropdown-trigger {\n                display: flex;\n                align-items: center;\n            }\n\n            .dropdown-trigger .name {\n                white-space: nowrap;\n                overflow: hidden;\n                text-overflow: ellipsis;\n                min-width: 0;\n                margin-right: 0.5em\n            }\n        `;\n    }\n\n    setChevron(name) {\n        const chevron = this.shadowRoot.querySelector(\"#menu-chevron-icon\");\n        if (chevron !== null) {\n            chevron.name = name;\n        }\n    }\n\n    onDropdownClick(event) {\n        event.stopPropagation();\n        event.currentTarget.classList.toggle('is-active');\n        this.setChevron(event.currentTarget.classList.contains('is-active') ? 'chevron-up' : 'chevron-down');\n        this.updateDropdownWidth();\n    }\n\n    closeDropdown() {\n        var dropdowns = this.shadowRoot.querySelectorAll('.dropdown');\n        dropdowns.forEach(function (el) {\n            el.classList.remove('is-active');\n        });\n        this.setChevron('chevron-down');\n    }\n\n    renderLoggedIn() {\n        const person = this._loginData.person;\n        const imageURL = (this.showImage && person && person.image) ? person.image : null;\n\n        return html`\n            <div class=\"dropdown\" @click=\"${this.onDropdownClick}\">\n                <a href=\"#\">\n                    <div class=\"dropdown-trigger login-button\">\n                        <div class=\"name\">${this._loginData.name}</div>\n                        <dbp-icon class=\"menu-icon\" name=\"chevron-down\" id=\"menu-chevron-icon\"></dbp-icon>\n                    </div>\n                </a>\n                <div class=\"dropdown-menu\" id=\"dropdown-menu2\" role=\"menu\">\n                    <div class=\"dropdown-content\" @blur=\"${this.closeDropdown}\">\n                        ${imageURL ? html`<div class=\"dropdown-item\"><img alt=\"\" src=\"${imageURL}\"></div>` : ''}\n                        <div class=\"menu\">\n                            <a href=\"#\" @click=\"${this.onLogoutClicked}\" class=\"dropdown-item\">${i18n.t('logout')}</a>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n\n    renderLoggedOut() {\n        let loginSVG = `\n        <svg\n           viewBox=\"0 0 100 100\"\n           y=\"0px\"\n           x=\"0px\"\n           id=\"icon\"\n           role=\"img\"\n           version=\"1.1\">\n        <g\n           id=\"g6\">\n            <path\n           style=\"stroke-width:1.33417916\"\n           id=\"path2\"\n           d=\"m 42.943908,38.894934 5.885859,6.967885 H 5.4215537 c -1.8393311,0 -3.4334181,1.741972 -3.4334181,4.064599 0,2.322628 1.4714649,4.064599 3.4334181,4.064599 H 48.829767 L 42.943908,60.9599 c -1.348843,1.596808 -1.348843,4.064599 0,5.661406 1.348843,1.596808 3.433418,1.596808 4.782261,0 L 61.705085,49.927418 47.726169,33.378693 c -1.348843,-1.596806 -3.433418,-1.596806 -4.782261,0 -1.348843,1.596807 -1.348843,4.064599 0,5.516241 z\" />\n            <path\n           id=\"path4\"\n           d=\"m 50,2.3007812 c -18.777325,0 -35.049449,10.9124408 -42.8261719,26.7246098 H 13.390625 C 20.672112,16.348362 34.336876,7.8007812 50,7.8007812 73.3,7.8007812 92.300781,26.7 92.300781,50 92.300781,73.3 73.3,92.300781 50,92.300781 c -15.673389,0 -29.345175,-8.60579 -36.623047,-21.326172 H 7.1640625 C 14.942553,86.8272 31.242598,97.800781 50.099609,97.800781 76.399609,97.800781 97.900391,76.4 97.900391,50 97.800391,23.7 76.3,2.3007812 50,2.3007812 Z\" />\n        </g>\n        </svg>\n        `;\n\n        return html`\n            <a href=\"#\" @click=\"${this.onLoginClicked}\">\n                <div class=\"login-box login-button\">\n                    <div class=\"icon\">${unsafeHTML(loginSVG)}</div>\n                    <div class=\"label\">${i18n.t('login')}</div>\n                </div>\n            </a>\n        `;\n    }\n\n    render() {\n        const loggedIn = (this._loginData.status === 'logged-in');\n        return html`\n            <div class=\"authbox\">\n                ${loggedIn ? this.renderLoggedIn() : this.renderLoggedOut()}\n            </div>\n        `;\n    }\n}","import {createInstance} from '@dbp-toolkit/common/i18next.js';\n\nimport de from './i18n/de/translation.json';\nimport en from './i18n/en/translation.json';\n\nexport const i18n = createInstance({en: en, de: de}, 'de', 'en');","import {i18n} from './i18n';\nimport {createUUID} from './utils'\nimport {css, html} from 'lit-element';\nimport DBPLitElement from '@dbp-toolkit/common/dbp-lit-element';\nimport * as commonUtils from '@dbp-toolkit/common/utils';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\n\n/**\n * Notification web component\n */\nexport class Notification extends DBPLitElement {\n    constructor() {\n        super();\n        this.lang = 'de';\n    }\n\n    /**\n     * See: https://lit-element.polymer-project.org/guide/properties#initialize\n     */\n    static get properties() {\n        return {\n            lang: { type: String },\n        };\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n        i18n.changeLanguage(this.lang);\n        const that = this;\n\n        const listener = window.addEventListener(\"dbp-notification-send\", (e) => {\n            if (typeof e.detail === 'undefined') {\n                return;\n            }\n\n            that.notificationBlock = that._(\"#notification\");\n            const notificationId = `notification-${createUUID()}`;\n\n            const type = typeof e.detail.type !== 'undefined' ? e.detail.type : \"info\";\n            const body = typeof e.detail.body !== 'undefined' ? e.detail.body : \"\";\n            const summary = typeof e.detail.summary !== 'undefined' ? e.detail.summary : \"\";\n            const timeout = typeof e.detail.timeout !== 'undefined' ? e.detail.timeout : 0;\n            const icon = typeof e.detail.icon !== 'undefined' ? e.detail.icon : '';\n            const iconHTML = icon !== '' ? `<dbp-icon name=\"${icon}\"></dbp-icon>` : \"\";\n            const summaryHTML = summary !== \"\" ? `<h3>${summary}</h3>` : \"\";\n\n            that.notificationBlock.innerHTML = `\n                <div id=\"${notificationId}\" class=\"notification is-${type}\">\n                    <button id=\"${notificationId}-button\" onclick=\"parentNode.parentNode.removeChild(parentNode)\" class=\"delete\"></button>\n                    ${summaryHTML}\n                    ${iconHTML} ${body}\n                </div>\n            ` + that.notificationBlock.innerHTML;\n\n            const messageId = `#${notificationId}`;\n\n            if (timeout > 0) {\n                setTimeout(() => {\n                    that.removeMessageId(messageId);\n                }, timeout * 1000);\n            }\n\n            // mark the event as handled\n            e.preventDefault();\n        });\n\n        this.updateComplete.then(()=>{\n        });\n    }\n\n    removeMessageId(messageElementId) {\n        const element = this._(messageElementId);\n\n        if (element) {\n            this.notificationBlock.removeChild(element);\n        }\n    }\n\n    static get styles() {\n        // language=css\n        return css`\n            ${commonStyles.getThemeCSS()}\n            ${commonStyles.getGeneralCSS()}\n            ${commonStyles.getNotificationCSS()}\n\n            .notification:not(:last-child) {\n                margin-bottom: 1.5rem;\n            }\n\n            .notification h3 {\n                font-weight: bold;\n                margin-bottom: 3px;\n            }\n\n            .delete, .modal-close {\n                -moz-appearance: none;\n                -webkit-appearance: none;\n                background-color: rgba(10,10,10,.2);\n                border: none;\n                border-radius: 290486px;\n                cursor: pointer;\n                pointer-events: auto;\n                display: inline-block;\n                flex-grow: 0;\n                flex-shrink: 0;\n                font-size: 0;\n                height: 20px;\n                max-height: 20px;\n                max-width: 20px;\n                min-height: 20px;\n                min-width: 20px;\n                outline: 0;\n                position: relative;\n                vertical-align: top;\n                width: 20px;\n            }\n\n            .delete::before, .modal-close::before, .delete::after, .modal-close::after {\n                background-color: white;\n                content: \"\";\n                display: block;\n                left: 50%;\n                position: absolute;\n                top: 50%;\n                -webkit-transform: translateX(-50%) translateY(-50%) rotate(45deg);\n                        transform: translateX(-50%) translateY(-50%) rotate(45deg);\n                -webkit-transform-origin: center center;\n                        transform-origin: center center;\n            }\n\n            .delete::before, .modal-close::before {\n                height: 2px;\n                width: 50%;\n            }\n\n            .delete::after, .modal-close::after {\n                height: 50%;\n                width: 2px;\n            }\n\n            .delete:hover, .modal-close:hover, .delete:focus, .modal-close:focus {\n                background-color: rgba(10, 10, 10, 0.3);\n            }\n\n            .delete:active, .modal-close:active {\n                background-color: rgba(10, 10, 10, 0.4);\n            }\n\n            #notification {\n                position: fixed; top: 0; max-width: 500px; margin: 0.75em auto; left: 0; right: 0; z-index: 1000; padding: 0;\n            }\n\n            .notification h3 {\n                margin: 0 0 3px 0;\n                font: inherit;\n                font-weight: bold; \n            }\n        `;\n    }\n\n    render() {\n        return html`\n            <div class=\"columns\">\n                <div class=\"column\" id=\"notification\">\n                </div>\n            </div>\n        `;\n    }\n}","export const createUUID = () => {\n    let dt = new Date().getTime();\n    const uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (dt + Math.random()*16)%16 | 0;\n        dt = Math.floor(dt/16);\n        return (c==='x' ? r :(r&0x3|0x8)).toString(16);\n    });\n\n    return uuid;\n};\n\n","export default {\"info\":\"c813ea8\",\"url\":\"https://github.com/krakenh2020/EduPilotPrototype1/commit/c813ea8\",\"time\":\"2020-12-03T17:34:00.929Z\",\"env\":\"kraken\"}","/**\n * Tokenize input string.\n */\nfunction lexer(str) {\n    var tokens = [];\n    var i = 0;\n    while (i < str.length) {\n        var char = str[i];\n        if (char === \"*\" || char === \"+\" || char === \"?\") {\n            tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"\\\\\") {\n            tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n            continue;\n        }\n        if (char === \"{\") {\n            tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \"}\") {\n            tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n            continue;\n        }\n        if (char === \":\") {\n            var name = \"\";\n            var j = i + 1;\n            while (j < str.length) {\n                var code = str.charCodeAt(j);\n                if (\n                // `0-9`\n                (code >= 48 && code <= 57) ||\n                    // `A-Z`\n                    (code >= 65 && code <= 90) ||\n                    // `a-z`\n                    (code >= 97 && code <= 122) ||\n                    // `_`\n                    code === 95) {\n                    name += str[j++];\n                    continue;\n                }\n                break;\n            }\n            if (!name)\n                throw new TypeError(\"Missing parameter name at \" + i);\n            tokens.push({ type: \"NAME\", index: i, value: name });\n            i = j;\n            continue;\n        }\n        if (char === \"(\") {\n            var count = 1;\n            var pattern = \"\";\n            var j = i + 1;\n            if (str[j] === \"?\") {\n                throw new TypeError(\"Pattern cannot start with \\\"?\\\" at \" + j);\n            }\n            while (j < str.length) {\n                if (str[j] === \"\\\\\") {\n                    pattern += str[j++] + str[j++];\n                    continue;\n                }\n                if (str[j] === \")\") {\n                    count--;\n                    if (count === 0) {\n                        j++;\n                        break;\n                    }\n                }\n                else if (str[j] === \"(\") {\n                    count++;\n                    if (str[j + 1] !== \"?\") {\n                        throw new TypeError(\"Capturing groups are not allowed at \" + j);\n                    }\n                }\n                pattern += str[j++];\n            }\n            if (count)\n                throw new TypeError(\"Unbalanced pattern at \" + i);\n            if (!pattern)\n                throw new TypeError(\"Missing pattern at \" + i);\n            tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n            i = j;\n            continue;\n        }\n        tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n    }\n    tokens.push({ type: \"END\", index: i, value: \"\" });\n    return tokens;\n}\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str, options) {\n    if (options === void 0) { options = {}; }\n    var tokens = lexer(str);\n    var _a = options.prefixes, prefixes = _a === void 0 ? \"./\" : _a;\n    var defaultPattern = \"[^\" + escapeString(options.delimiter || \"/#?\") + \"]+?\";\n    var result = [];\n    var key = 0;\n    var i = 0;\n    var path = \"\";\n    var tryConsume = function (type) {\n        if (i < tokens.length && tokens[i].type === type)\n            return tokens[i++].value;\n    };\n    var mustConsume = function (type) {\n        var value = tryConsume(type);\n        if (value !== undefined)\n            return value;\n        var _a = tokens[i], nextType = _a.type, index = _a.index;\n        throw new TypeError(\"Unexpected \" + nextType + \" at \" + index + \", expected \" + type);\n    };\n    var consumeText = function () {\n        var result = \"\";\n        var value;\n        // tslint:disable-next-line\n        while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n            result += value;\n        }\n        return result;\n    };\n    while (i < tokens.length) {\n        var char = tryConsume(\"CHAR\");\n        var name = tryConsume(\"NAME\");\n        var pattern = tryConsume(\"PATTERN\");\n        if (name || pattern) {\n            var prefix = char || \"\";\n            if (prefixes.indexOf(prefix) === -1) {\n                path += prefix;\n                prefix = \"\";\n            }\n            if (path) {\n                result.push(path);\n                path = \"\";\n            }\n            result.push({\n                name: name || key++,\n                prefix: prefix,\n                suffix: \"\",\n                pattern: pattern || defaultPattern,\n                modifier: tryConsume(\"MODIFIER\") || \"\"\n            });\n            continue;\n        }\n        var value = char || tryConsume(\"ESCAPED_CHAR\");\n        if (value) {\n            path += value;\n            continue;\n        }\n        if (path) {\n            result.push(path);\n            path = \"\";\n        }\n        var open = tryConsume(\"OPEN\");\n        if (open) {\n            var prefix = consumeText();\n            var name_1 = tryConsume(\"NAME\") || \"\";\n            var pattern_1 = tryConsume(\"PATTERN\") || \"\";\n            var suffix = consumeText();\n            mustConsume(\"CLOSE\");\n            result.push({\n                name: name_1 || (pattern_1 ? key++ : \"\"),\n                pattern: name_1 && !pattern_1 ? defaultPattern : pattern_1,\n                prefix: prefix,\n                suffix: suffix,\n                modifier: tryConsume(\"MODIFIER\") || \"\"\n            });\n            continue;\n        }\n        mustConsume(\"END\");\n    }\n    return result;\n}\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile(str, options) {\n    return tokensToFunction(parse(str, options), options);\n}\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction(tokens, options) {\n    if (options === void 0) { options = {}; }\n    var reFlags = flags(options);\n    var _a = options.encode, encode = _a === void 0 ? function (x) { return x; } : _a, _b = options.validate, validate = _b === void 0 ? true : _b;\n    // Compile all the tokens into regexps.\n    var matches = tokens.map(function (token) {\n        if (typeof token === \"object\") {\n            return new RegExp(\"^(?:\" + token.pattern + \")$\", reFlags);\n        }\n    });\n    return function (data) {\n        var path = \"\";\n        for (var i = 0; i < tokens.length; i++) {\n            var token = tokens[i];\n            if (typeof token === \"string\") {\n                path += token;\n                continue;\n            }\n            var value = data ? data[token.name] : undefined;\n            var optional = token.modifier === \"?\" || token.modifier === \"*\";\n            var repeat = token.modifier === \"*\" || token.modifier === \"+\";\n            if (Array.isArray(value)) {\n                if (!repeat) {\n                    throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to not repeat, but got an array\");\n                }\n                if (value.length === 0) {\n                    if (optional)\n                        continue;\n                    throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to not be empty\");\n                }\n                for (var j = 0; j < value.length; j++) {\n                    var segment = encode(value[j], token);\n                    if (validate && !matches[i].test(segment)) {\n                        throw new TypeError(\"Expected all \\\"\" + token.name + \"\\\" to match \\\"\" + token.pattern + \"\\\", but got \\\"\" + segment + \"\\\"\");\n                    }\n                    path += token.prefix + segment + token.suffix;\n                }\n                continue;\n            }\n            if (typeof value === \"string\" || typeof value === \"number\") {\n                var segment = encode(String(value), token);\n                if (validate && !matches[i].test(segment)) {\n                    throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to match \\\"\" + token.pattern + \"\\\", but got \\\"\" + segment + \"\\\"\");\n                }\n                path += token.prefix + segment + token.suffix;\n                continue;\n            }\n            if (optional)\n                continue;\n            var typeOfMessage = repeat ? \"an array\" : \"a string\";\n            throw new TypeError(\"Expected \\\"\" + token.name + \"\\\" to be \" + typeOfMessage);\n        }\n        return path;\n    };\n}\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match(str, options) {\n    var keys = [];\n    var re = pathToRegexp(str, keys, options);\n    return regexpToFunction(re, keys, options);\n}\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction(re, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.decode, decode = _a === void 0 ? function (x) { return x; } : _a;\n    return function (pathname) {\n        var m = re.exec(pathname);\n        if (!m)\n            return false;\n        var path = m[0], index = m.index;\n        var params = Object.create(null);\n        var _loop_1 = function (i) {\n            // tslint:disable-next-line\n            if (m[i] === undefined)\n                return \"continue\";\n            var key = keys[i - 1];\n            if (key.modifier === \"*\" || key.modifier === \"+\") {\n                params[key.name] = m[i].split(key.prefix + key.suffix).map(function (value) {\n                    return decode(value, key);\n                });\n            }\n            else {\n                params[key.name] = decode(m[i], key);\n            }\n        };\n        for (var i = 1; i < m.length; i++) {\n            _loop_1(i);\n        }\n        return { path: path, index: index, params: params };\n    };\n}\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str) {\n    return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options) {\n    return options && options.sensitive ? \"\" : \"i\";\n}\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path, keys) {\n    if (!keys)\n        return path;\n    var groupsRegex = /\\((?:\\?<(.*?)>)?(?!\\?)/g;\n    var index = 0;\n    var execResult = groupsRegex.exec(path.source);\n    while (execResult) {\n        keys.push({\n            // Use parenthesized substring match if available, index otherwise\n            name: execResult[1] || index++,\n            prefix: \"\",\n            suffix: \"\",\n            modifier: \"\",\n            pattern: \"\"\n        });\n        execResult = groupsRegex.exec(path.source);\n    }\n    return path;\n}\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(paths, keys, options) {\n    var parts = paths.map(function (path) { return pathToRegexp(path, keys, options).source; });\n    return new RegExp(\"(?:\" + parts.join(\"|\") + \")\", flags(options));\n}\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(path, keys, options) {\n    return tokensToRegexp(parse(path, options), keys, options);\n}\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(tokens, keys, options) {\n    if (options === void 0) { options = {}; }\n    var _a = options.strict, strict = _a === void 0 ? false : _a, _b = options.start, start = _b === void 0 ? true : _b, _c = options.end, end = _c === void 0 ? true : _c, _d = options.encode, encode = _d === void 0 ? function (x) { return x; } : _d;\n    var endsWith = \"[\" + escapeString(options.endsWith || \"\") + \"]|$\";\n    var delimiter = \"[\" + escapeString(options.delimiter || \"/#?\") + \"]\";\n    var route = start ? \"^\" : \"\";\n    // Iterate over the tokens and create our regexp string.\n    for (var _i = 0, tokens_1 = tokens; _i < tokens_1.length; _i++) {\n        var token = tokens_1[_i];\n        if (typeof token === \"string\") {\n            route += escapeString(encode(token));\n        }\n        else {\n            var prefix = escapeString(encode(token.prefix));\n            var suffix = escapeString(encode(token.suffix));\n            if (token.pattern) {\n                if (keys)\n                    keys.push(token);\n                if (prefix || suffix) {\n                    if (token.modifier === \"+\" || token.modifier === \"*\") {\n                        var mod = token.modifier === \"*\" ? \"?\" : \"\";\n                        route += \"(?:\" + prefix + \"((?:\" + token.pattern + \")(?:\" + suffix + prefix + \"(?:\" + token.pattern + \"))*)\" + suffix + \")\" + mod;\n                    }\n                    else {\n                        route += \"(?:\" + prefix + \"(\" + token.pattern + \")\" + suffix + \")\" + token.modifier;\n                    }\n                }\n                else {\n                    route += \"(\" + token.pattern + \")\" + token.modifier;\n                }\n            }\n            else {\n                route += \"(?:\" + prefix + suffix + \")\" + token.modifier;\n            }\n        }\n    }\n    if (end) {\n        if (!strict)\n            route += delimiter + \"?\";\n        route += !options.endsWith ? \"$\" : \"(?=\" + endsWith + \")\";\n    }\n    else {\n        var endToken = tokens[tokens.length - 1];\n        var isEndDelimited = typeof endToken === \"string\"\n            ? delimiter.indexOf(endToken[endToken.length - 1]) > -1\n            : // tslint:disable-next-line\n                endToken === undefined;\n        if (!strict) {\n            route += \"(?:\" + delimiter + \"(?=\" + endsWith + \"))?\";\n        }\n        if (!isEndDelimited) {\n            route += \"(?=\" + delimiter + \"|\" + endsWith + \")\";\n        }\n    }\n    return new RegExp(route, flags(options));\n}\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(path, keys, options) {\n    if (path instanceof RegExp)\n        return regexpToRegexp(path, keys);\n    if (Array.isArray(path))\n        return arrayToRegexp(path, keys, options);\n    return stringToRegexp(path, keys, options);\n}\n//# sourceMappingURL=index.js.map","/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */\n\nimport { match } from 'path-to-regexp';\n\nfunction decode(val) {\n  try {\n    return decodeURIComponent(val);\n  } catch (err) {\n    return val;\n  }\n}\n\nfunction matchRoute(route, baseUrl, options, pathname, parentParams) {\n  var matchResult;\n  var childMatches;\n  var childIndex = 0;\n  return {\n    next: function next(routeToSkip) {\n      if (route === routeToSkip) {\n        return {\n          done: true,\n          value: false\n        };\n      }\n\n      if (!matchResult) {\n        var rt = route;\n        var end = !rt.children;\n\n        if (!rt.match) {\n          rt.match = match(rt.path || '', Object.assign({\n            end: end\n          }, options));\n        }\n\n        matchResult = rt.match(pathname);\n\n        if (matchResult) {\n          var _matchResult = matchResult,\n              path = _matchResult.path;\n          matchResult.path = !end && path.charAt(path.length - 1) === '/' ? path.substr(1) : path;\n          matchResult.params = Object.assign({}, parentParams, {}, matchResult.params);\n          return {\n            done: false,\n            value: {\n              route: route,\n              baseUrl: baseUrl,\n              path: matchResult.path,\n              params: matchResult.params\n            }\n          };\n        }\n      }\n\n      if (matchResult && route.children) {\n        while (childIndex < route.children.length) {\n          if (!childMatches) {\n            var childRoute = route.children[childIndex];\n            childRoute.parent = route;\n            childMatches = matchRoute(childRoute, baseUrl + matchResult.path, options, pathname.substr(matchResult.path.length), matchResult.params);\n          }\n\n          var childMatch = childMatches.next(routeToSkip);\n\n          if (!childMatch.done) {\n            return {\n              done: false,\n              value: childMatch.value\n            };\n          }\n\n          childMatches = null;\n          childIndex++;\n        }\n      }\n\n      return {\n        done: true,\n        value: false\n      };\n    }\n  };\n}\n\nfunction resolveRoute(context, params) {\n  if (typeof context.route.action === 'function') {\n    return context.route.action(context, params);\n  }\n\n  return undefined;\n}\n\nfunction isChildRoute(parentRoute, childRoute) {\n  var route = childRoute;\n\n  while (route) {\n    route = route.parent;\n\n    if (route === parentRoute) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar UniversalRouter = function () {\n  function UniversalRouter(routes, options) {\n    if (!routes || typeof routes !== 'object') {\n      throw new TypeError('Invalid routes');\n    }\n\n    this.options = Object.assign({\n      decode: decode\n    }, options);\n    this.baseUrl = this.options.baseUrl || '';\n    this.root = Array.isArray(routes) ? {\n      path: '',\n      children: routes,\n      parent: null\n    } : routes;\n    this.root.parent = null;\n  }\n\n  var _proto = UniversalRouter.prototype;\n\n  _proto.resolve = function resolve(pathnameOrContext) {\n    var _this = this;\n\n    var context = Object.assign({\n      router: this\n    }, this.options.context, {}, typeof pathnameOrContext === 'string' ? {\n      pathname: pathnameOrContext\n    } : pathnameOrContext);\n    var matchResult = matchRoute(this.root, this.baseUrl, this.options, context.pathname.substr(this.baseUrl.length));\n    var resolve = this.options.resolveRoute || resolveRoute;\n    var matches;\n    var nextMatches;\n    var currentContext = context;\n\n    function next(resume, parent, prevResult) {\n      if (parent === void 0) {\n        parent = !matches.done && matches.value.route;\n      }\n\n      var routeToSkip = prevResult === null && !matches.done && matches.value.route;\n      matches = nextMatches || matchResult.next(routeToSkip);\n      nextMatches = null;\n\n      if (!resume) {\n        if (matches.done || !isChildRoute(parent, matches.value.route)) {\n          nextMatches = matches;\n          return Promise.resolve(null);\n        }\n      }\n\n      if (matches.done) {\n        var error = new Error('Route not found');\n        error.status = 404;\n        return Promise.reject(error);\n      }\n\n      currentContext = Object.assign({}, context, {}, matches.value);\n      return Promise.resolve(resolve(currentContext, matches.value.params)).then(function (result) {\n        if (result !== null && result !== undefined) {\n          return result;\n        }\n\n        return next(resume, parent, result);\n      });\n    }\n\n    context.next = next;\n    return Promise.resolve().then(function () {\n      return next(true, _this.root);\n    })[\"catch\"](function (error) {\n      if (_this.options.errorHandler) {\n        return _this.options.errorHandler(error, currentContext);\n      }\n\n      throw error;\n    });\n  };\n\n  return UniversalRouter;\n}();\n\nexport default UniversalRouter;\n//# sourceMappingURL=module.js.map\n","/*! Universal Router | MIT License | https://www.kriasoft.com/universal-router/ */\n\nimport { parse, tokensToFunction } from 'path-to-regexp';\n\nfunction cacheRoutes(routesByName, route, routes) {\n  if (route.name && routesByName.has(route.name)) {\n    throw new Error(\"Route \\\"\" + route.name + \"\\\" already exists\");\n  }\n\n  if (route.name) {\n    routesByName.set(route.name, route);\n  }\n\n  if (routes) {\n    for (var i = 0; i < routes.length; i++) {\n      var childRoute = routes[i];\n      childRoute.parent = route;\n      cacheRoutes(routesByName, childRoute, childRoute.children);\n    }\n  }\n}\n\nfunction generateUrls(router, options) {\n  if (!router) {\n    throw new ReferenceError('Router is not defined');\n  }\n\n  var routesByName = new Map();\n  var regexpByRoute = new Map();\n  var opts = Object.assign({\n    encode: encodeURIComponent\n  }, options);\n  return function (routeName, params) {\n    var route = routesByName.get(routeName);\n\n    if (!route) {\n      routesByName.clear();\n      regexpByRoute.clear();\n      cacheRoutes(routesByName, router.root, router.root.children);\n      route = routesByName.get(routeName);\n\n      if (!route) {\n        throw new Error(\"Route \\\"\" + routeName + \"\\\" not found\");\n      }\n    }\n\n    var regexp = regexpByRoute.get(route);\n\n    if (!regexp) {\n      var fullPath = '';\n      var rt = route;\n\n      while (rt) {\n        var path = Array.isArray(rt.path) ? rt.path[0] : rt.path;\n\n        if (path) {\n          fullPath = path + fullPath;\n        }\n\n        rt = rt.parent;\n      }\n\n      var tokens = parse(fullPath, opts);\n      var toPath = tokensToFunction(tokens, opts);\n      var keys = Object.create(null);\n\n      for (var i = 0; i < tokens.length; i++) {\n        var token = tokens[i];\n\n        if (typeof token !== 'string') {\n          keys[token.name] = true;\n        }\n      }\n\n      regexp = {\n        toPath: toPath,\n        keys: keys\n      };\n      regexpByRoute.set(route, regexp);\n    }\n\n    var url = router.baseUrl + regexp.toPath(params) || '/';\n\n    if (opts.stringifyQueryParams && params) {\n      var queryParams = {};\n\n      var _keys = Object.keys(params);\n\n      for (var _i = 0; _i < _keys.length; _i++) {\n        var key = _keys[_i];\n\n        if (!regexp.keys[key]) {\n          queryParams[key] = params[key];\n        }\n      }\n\n      var query = opts.stringifyQueryParams(queryParams);\n\n      if (query) {\n        url += query.charAt(0) === '?' ? query : \"?\" + query;\n      }\n    }\n\n    return url;\n  };\n}\n\nexport default generateUrls;\n//# sourceMappingURL=module.js.map\n","import UniversalRouter from 'universal-router';\nimport generateUrls from 'universal-router/generateUrls';\n\n/**\n * A wrapper around UniversalRouter which adds history integration\n */\nexport class Router {\n\n    /**\n     * @param {Array} routes The routes passed to UniversalRouter\n     * @param {object} options Options\n     * @param {string} options.routeName The main route name\n     * @param {Function} options.getState Function which should return the current state\n     * @param {Function} options.setState Function which gets passed the new state based on the route\n     * @param {object} unioptions options passed to UniversalRouter\n     */\n    constructor(routes, options, unioptions) {\n        this.getState = options.getState;\n        this.setState = options.setState;\n        // XXX: We only have one route atm\n        // If we need more we need to pass the route name to each function\n        this.routeName = options.routeName;\n\n        console.assert(this.getState);\n        console.assert(this.setState);\n        console.assert(this.routeName);\n\n        // https://github.com/kriasoft/universal-router\n        this.router = new UniversalRouter(routes, unioptions);\n\n        window.addEventListener('popstate', (event) => {\n            this.setStateFromCurrentLocation();\n            this.dispatchLocationChanged();\n        });\n    }\n\n    /**\n     * In case something else has changed the location, update the app state accordingly.\n     */\n    setStateFromCurrentLocation() {\n        const oldPathName = location.pathname;\n        this.router.resolve({pathname: oldPathName}).then(page => {\n            const newPathname = this.getPathname(page);\n            // In case of a router redirect, set the new location\n            if (newPathname !== oldPathName) {\n                const referrerUrl = location.href;\n                window.history.replaceState({}, '', newPathname);\n                this.dispatchLocationChanged(referrerUrl);\n            }\n            this.setState(page);\n        }).catch((e) => {\n            // In case we can't resolve the location, just leave things as is.\n            // This happens when a user enters a wrong URL or when testing with karma.\n        });\n    }\n\n    /**\n     * Update the router after some internal state change.\n     */\n    update() {\n        // Queue updates so we can call this multiple times when changing state\n        // without it resulting in multiple location changes\n        setTimeout(() => {\n            const newPathname = this.getPathname();\n            const oldPathname = location.pathname;\n            if (newPathname === oldPathname)\n                return;\n            const referrerUrl = location.href;\n            window.history.pushState({}, '', newPathname);\n            this.dispatchLocationChanged(referrerUrl);\n        });\n    }\n\n    /**\n     * Given a new routing path set the location and the app state.\n     *\n     * @param {string} pathname\n     */\n    updateFromPathname(pathname) {\n        this.router.resolve({pathname: pathname}).then(page => {\n            if (location.pathname === pathname)\n                return;\n            const referrerUrl = location.href;\n            window.history.pushState({}, '', pathname);\n            this.setState(page);\n            this.dispatchLocationChanged(referrerUrl);\n        }).catch((err) => {\n            throw new Error(`Route not found: ${pathname}: ${err}`);\n        });\n    }\n\n    /**\n     * Pass some new router state to get a new router path that can\n     * be passed to updateFromPathname() later on. If nothing is\n     * passed the current state is used.\n     *\n     * @param {object} [partialState] The optional partial new state\n     * @returns {string} The new path\n     */\n    getPathname(partialState) {\n        const currentState = this.getState();\n        if (partialState === undefined)\n            partialState = {};\n        let combined = {...currentState, ...partialState};\n        return generateUrls(this.router)(this.routeName, combined);\n    }\n\n    dispatchLocationChanged(referrerUrl = \"\") {\n        // fire a locationchanged event\n        window.dispatchEvent(new CustomEvent('locationchanged', {\n            detail: {\n                referrerUrl: referrerUrl,\n            },\n            bubbles: true\n        }));\n    }\n}\n","import {html, LitElement, css} from 'lit-element';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\nimport buildinfo from 'consts:buildinfo';\n\nexport class BuildInfo extends LitElement {\n\n    constructor() {\n        super();\n    }\n\n    static get styles() {\n        return css`\n            ${commonStyles.getThemeCSS()}\n            ${commonStyles.getGeneralCSS()}\n            ${commonStyles.getTagCSS()}\n\n            :host {\n                display: inline-block;\n            }\n        `;\n    } \n\n    render() {\n        const date = new Date(buildinfo.time);\n\n        return html`\n            <a href=\"${buildinfo.url}\" style=\"float: right\">\n                <div class=\"tags has-addons\" title=\"Build Time: ${date.toString()}\">\n                    <span class=\"tag is-light\">build</span>\n                    <span class=\"tag is-dark\">${buildinfo.info} (${buildinfo.env})</span>\n                </div>\n            </a>\n        `;\n    }\n}","import {html, LitElement, css} from 'lit-element';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\nimport {createI18nInstance} from './i18n.js';\n\nconst i18n = createI18nInstance();\n\nexport class TUGrazLogo extends LitElement {\n\n    constructor() {\n        super();\n\n        this.lang = i18n.language;\n    }\n\n    static get properties() {\n        return {\n            lang: { type: String }\n        };\n    }\n\n    update(changedProperties) {\n        changedProperties.forEach((oldValue, propName) => {\n            if (propName === \"lang\") {\n                i18n.changeLanguage(this.lang);\n            }\n        });\n        super.update(changedProperties);\n    }\n\n    static get styles() {\n        return css`\n            ${commonStyles.getThemeCSS()}\n            ${commonStyles.getGeneralCSS()}\n\n            :host {\n                display: inline-block;\n            }\n\n            #claim\n            {\n                font-size: 12px;\n                text-align: right;\n                padding: 0 17px 0 0;\n                line-height: 17px;\n                letter-spacing: 2px;\n                vertical-align: top;\n                text-transform: uppercase;\n                display: inline-block;\n                white-space: nowrap;\n            }\n\n            #img {\n                overflow: visible;\n            }\n\n            a:hover path, a:focus path {\n                fill:#000 !important;\n                transition:none;\n            }\n\n             * {\n                transition:fill 0.15s, stroke 0.15s;\n            }\n        `;\n    } \n\n    render() {\n        return html`\n            <a href=\"https://www.tugraz.at\" title=\"TU Graz Home\" target=\"_blank\" rel=\"noopener\">\n                <div id=\"claim\">\n                    <div class=\"int-header-logo-claim-single\">${i18n.t('logo.word1')}</div>\n                    <div class=\"int-header-logo-claim-single\">${i18n.t('logo.word2')}</div>\n                    <div class=\"int-header-logo-claim-single\">${i18n.t('logo.word3')}</div>\n                </div>\n                <svg id=\"img\" xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\" xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" height=\"51.862\" width=\"141.1\" version=\"1.1\" xmlns:cc=\"http://creativecommons.org/ns#\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" viewBox=\"0 0 141.10001 51.862499\"><g transform=\"matrix(1.25 0 0 -1.25 0 51.862)\"><g transform=\"scale(.1)\"><path style=\"fill:#e4154b\" d=\"m0 103.73h207.45v207.46l-207.45 0.01v-207.47z\"></path><path style=\"fill:#e4154b\" d=\"m228.19 103.73h207.46v207.46h-207.46v-207.46z\"></path><path style=\"fill:#e4154b\" d=\"m456.41 103.73h207.44v207.46h-207.44v-207.46z\"></path><path style=\"fill:#e4154b\" d=\"m103.72 0h207.47v207.46h-207.47v-207.46z\"></path><path style=\"fill:#e4154b\" d=\"m352.68 207.46h207.44v207.46h-207.44v-207.46z\"></path><path style=\"fill:#231f20\" d=\"m751.04 277.91h-66.426v33.195h171.19v-33.195h-66.407v-173.73h-38.359v173.73\"></path><path style=\"fill:#231f20\" d=\"m1048.3 180.22c0-12.461-2.25-23.711-6.72-33.75-4.5-10.039-10.61-18.555-18.36-25.567-7.76-7.031-16.9-12.421-27.503-16.21-10.605-3.809-22.109-5.7036-34.551-5.7036-12.422 0-23.945 1.8946-34.551 5.7036-10.605 3.789-19.824 9.179-27.656 16.21-7.851 7.012-13.984 15.528-18.34 25.567-4.394 10.039-6.582 21.289-6.582 33.75v130.89h38.379v-129.59c0-5.039 0.801-10.351 2.442-15.898 1.64-5.547 4.336-10.664 8.125-15.332s8.789-8.516 15.039-11.523c6.211-3.008 13.926-4.512 23.144-4.512 9.199 0 16.914 1.504 23.145 4.512 6.23 3.007 11.25 6.855 15.039 11.523 3.77 4.668 6.48 9.785 8.12 15.332 1.63 5.547 2.45 10.859 2.45 15.898v129.59h38.38v-130.89\"></path><path style=\"fill:#231f20\" d=\"m832.56 75.664c-7.597 3.2812-17.46 4.8632-25.332 4.8632-22.929 0-35.605-14.434-35.605-33.184 0-18.613 12.383-32.637 33.34-32.637 5.351 0 9.59 0.5274 12.969 1.3086v23.867h-20.84v14.414h39.687v-49.297c-10.41-2.6172-21.25-4.707-31.816-4.707-31.797 0-53.906 14.805-53.906 45.742 0 31.348 20.566 48.906 53.906 48.906 11.406 0 20.41-1.4453 28.867-3.8086l-1.27-15.469\"></path><path style=\"fill:#231f20\" d=\"m856.2 69.375h16.758v-15.332h0.293c0.84 6.289 8.574 16.914 19.824 16.914 1.836 0 3.828 0 5.782-0.5273v-17.715c-1.68 0.918-5.059 1.4454-8.457 1.4454-15.333 0-15.333-17.832-15.333-27.52v-24.785h-18.867v67.52\"></path><path style=\"fill:#231f20\" d=\"m913.75 65.84c7.324 3.1446 17.187 5.1172 25.215 5.1172 22.09 0 31.23-8.5351 31.23-28.457v-8.6523c0-6.8165 0.156-11.934 0.293-16.914 0.137-5.1172 0.41-9.8242 0.84-15.078h-16.602c-0.703 3.5352-0.703 8.0078-0.839 10.098h-0.293c-4.36-7.4618-13.81-11.661-22.38-11.661-12.793 0-25.332 7.207-25.332 20.059 0 10.078 5.195 15.976 12.383 19.258 7.187 3.2812 16.464 3.9453 24.355 3.9453h10.41c0 10.879-5.195 14.551-16.328 14.551-8.008 0-16.035-2.8907-22.363-7.3438l-0.586 15.078zm22.11-52.715c5.782 0 10.274 2.3633 13.223 6.0352 3.105 3.8086 3.945 8.6523 3.945 13.906h-8.164c-8.437 0-20.957-1.3086-20.957-11.68 0-5.7617 5.195-8.2617 11.953-8.2617\"></path><path style=\"fill:#231f20\" d=\"m985.69 69.375h57.422v-14.414l-36.04-39.473h37.31v-13.633h-60.235v14.297l36.715 39.59h-35.172v13.633\"></path><path style=\"fill:#e4154b\" d=\"m1059.6 0h69.102v69.121h-69.102v-69.121z\"></path></g></g></svg>\n            </a>\n        `;\n    }\n}","import {createI18nInstance} from './i18n.js';\nimport {css, html, LitElement} from 'lit-element';\nimport {ScopedElementsMixin} from '@open-wc/scoped-elements';\nimport * as commonUtils from '@dbp-toolkit/common/utils';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\n\nconst i18n = createI18nInstance();\n\nclass AppShellWelcome extends ScopedElementsMixin(LitElement) {\n\n    constructor() {\n        super();\n        this.lang = i18n.language;\n    }\n\n    static get properties() {\n        return {\n            lang: { type: String },\n        };\n    }\n\n    static set app(app) {\n        this._app = app;\n    }\n\n    update(changedProperties) {\n        changedProperties.forEach((oldValue, propName) => {\n            if (propName === \"lang\") {\n                i18n.changeLanguage(this.lang);\n            }\n        });\n\n        super.update(changedProperties);\n    }\n\n    static get styles() {\n        // language=css\n        return css`\n            ${commonStyles.getThemeCSS()}\n            ${commonStyles.getGeneralCSS()}\n\n            p { line-height: 1.8em }\n            .item {padding-top: 0.5em;}\n            .description {padding-left: 2em;}\n\n            h2 a:hover {\n                color: #E4154B;\n            }\n        `;\n    }\n\n    render() {\n        const app = AppShellWelcome._app;\n        let metadata = app.metadata;\n        let itemTemplates = [];\n\n        const switchActivity = (e, data) => {\n            e.preventDefault();\n            app.switchComponent(data.routing_name);\n        };\n\n        for (let [key, data] of Object.entries(metadata)) {\n\n            if (data['visible'] && (key !== \"welcome\")) {\n                itemTemplates.push(html`\n                    <div class=\"item\">\n                        <h2><a href=\"#\" @click=${(e) => {switchActivity(e, data);}}>${data.name[this.lang]}</a></h2>\n                        <p class=\"description\">${data.description[this.lang]}</p>\n                    </div>`);\n            }\n        }\n\n        return html`\n            <p>${i18n.t('welcome.headline', {appname: app.topic.name[this.lang]})}\n            ${app.topic.description[this.lang] }</p>\n            <br>\n            ${itemTemplates}\n        `;\n    }\n}\n\nexport const appWelcomeMeta = {\n    \"element\": \"dbp-app-shell-welcome\",\n    \"module_src\": \"\",\n    \"routing_name\": \"welcome\",\n    \"name\": {\n      \"de\": \"Willkommen\",\n      \"en\": \"Welcome\"\n    },\n    \"short_name\": {\n      \"de\": \"Willkommen\",\n      \"en\": \"Welcome\"\n    },\n    \"description\": {\n      \"de\": \"\",\n      \"en\": \"\"\n    },\n    visible: true\n};\n\ncommonUtils.defineCustomElement('dbp-app-shell-welcome', AppShellWelcome);\n","import {createInstance} from '@dbp-toolkit/common/i18next.js';\n\nimport de from './i18n/de/translation.json';\nimport en from './i18n/en/translation.json';\n\nexport const i18n = createInstance({en: en, de: de}, 'de', 'en');","import {i18n} from './i18n.js';\nimport {LitElement} from \"lit-element\";\nimport DBPLitElement from '@dbp-toolkit/common/dbp-lit-element';\nimport {EventBus} from '@dbp-toolkit/common';\nimport buildInfo from 'consts:buildinfo';\n\n\nexport class MatomoElement extends DBPLitElement {\n\n    constructor() {\n        super();\n        this.endpoint = '';\n        this.siteId = -1;\n        this.isRunning = false;\n        this.lastEvent = [];\n    }\n\n\n    static get properties() {\n        return {\n            endpoint: { type: String },\n            siteId: { type: Number, attribute: 'site-id' },\n        };\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this._bus = new EventBus();\n        this._bus.subscribe('auth-update', (data) => {\n            this.setupMatomo(data.status === 'logged-in');\n        });\n    }\n\n    disconnectedCallback() {\n        this._bus.close();\n        super.disconnectedCallback();\n    }\n\n    render() {\n        return ``;\n    }\n\n    setupMatomo(loggedIn) {\n        if (loggedIn && ! this.isRunning) {\n            if (this.siteId === -1) {\n                console.log('site id missing, skipping matomo...');\n                return;\n            }\n            if (this.endpoint === '') {\n                console.log('endpoint missing, skipping matomo...');\n                return;\n            }\n            console.log('add matomo...');\n\n            window._paq = window._paq || [];\n            _paq.push(['setCustomVariable', 1, \"GitCommit\", buildInfo.info, \"visit\"]);\n            _paq.push(['enableHeartBeatTimer']);\n            _paq.push(['disableCookies']);\n            _paq.push(['trackPageView']);\n            _paq.push(['enableLinkTracking']);\n\n            (function (endpoint, siteId) {\n                _paq.push(['setTrackerUrl', endpoint+'matomo.php']);\n                _paq.push(['setSiteId', siteId]);\n\n                var g = document.createElement('script');\n                var s = document.getElementsByTagName('script')[0];\n                g.type = 'text/javascript';\n                g.async = true;\n                g.defer = true;\n                g.src = endpoint + 'matomo.js';\n                s.parentNode.insertBefore(g, s);\n            })(this.endpoint, this.siteId);\n\n            // track changed locations\n            window.addEventListener('locationchanged', function(e) {\n                _paq.push(['setReferrerUrl', e.detail.referrerUrl]);\n                _paq.push(['setCustomUrl', location.href]);\n                // _paq.push(['setDocumentTitle', '']);\n                _paq.push(['trackPageView']);\n\n                // make Matomo aware of newly added content\n                var content = document.getElementById('content');\n                _paq.push(['MediaAnalytics::scanForMedia', content]);\n                _paq.push(['FormAnalytics::scanForForms', content]);\n                _paq.push(['trackContentImpressionsWithinNode', content]);\n            });\n\n            // track errors\n            window.addEventListener('error', function(e) {\n                _paq.push(['trackEvent', 'Error', e.error.message + '\\n' + e.error.stack]);\n            });\n\n            this.isRunning = true;\n            if (this.lastEvent.length > 0) {\n                console.log('MatomoElement* (' + this.isRunning + '): ' + this.lastEvent[1] + ', ' + this.lastEvent[2]);\n                _paq.push(this.lastEvent);\n                this.lastEvent = [];\n            }\n            return;\n        }\n        if (! loggedIn && this.isRunning) {\n            // TODO: reomve those event listeners\n            console.log('remove matomo...');\n            this.isRunning = false;\n        }\n    }\n\n    track (action, message) {\n        console.log('MatomoElement  (' + this.isRunning + '): ' + action + ', ' + message);\n        const event = ['trackEvent', action, message];\n        if (this.isRunning) {\n            _paq.push(event);\n        } else {\n            this.lastEvent = event;\n        }\n    }\n}\n","import {createI18nInstance} from './i18n.js';\nimport {html, css, LitElement} from 'lit-element';\nimport {ScopedElementsMixin} from '@open-wc/scoped-elements';\nimport {LanguageSelect} from '@dbp-toolkit/language-select';\nimport {Icon, EventBus} from '@dbp-toolkit/common';\nimport {AuthKeycloak} from '@dbp-toolkit/auth';\nimport {AuthMenuButton} from './auth-menu-button.js';\nimport {Notification} from '@dbp-toolkit/notification';\nimport * as commonStyles from '@dbp-toolkit/common/styles';\nimport * as commonUtils from '@dbp-toolkit/common/utils';\nimport buildinfo from 'consts:buildinfo';\nimport {classMap} from 'lit-html/directives/class-map.js';\nimport {Router} from './router.js';\nimport {BuildInfo} from './build-info.js';\nimport {TUGrazLogo} from './tugraz-logo.js';\nimport {send as notify} from '@dbp-toolkit/common/notification';\nimport {appWelcomeMeta} from './dbp-app-shell-welcome.js';\nimport {MatomoElement} from \"@dbp-toolkit/matomo/src/matomo\";\n\n\nconst i18n = createI18nInstance();\n\n/**\n * In case the application gets updated future dynamic imports might fail.\n * This sends a notification suggesting the user to reload the page.\n *\n * uage: importNotify(import('<path>'));\n *\n * @param {Promise} promise\n */\nconst importNotify = async (promise) => {\n    try {\n        return await promise;\n    } catch (error) {\n        console.log(error);\n        notify({\n            \"body\": i18n.t('page-updated-needs-reload'),\n            \"type\": \"info\",\n            \"icon\": \"warning\"\n        });\n        throw error;\n    }\n};\n\nexport class AppShell extends ScopedElementsMixin(LitElement) {\n    constructor() {\n        super();\n        this.lang = i18n.language;\n        this.activeView = '';\n        this.entryPointUrl = commonUtils.getAPiUrl();\n        this.subtitle = '';\n        this.description = '';\n        this.routes = [];\n        this.metadata = {};\n        this.topic = {};\n        this.basePath = '/';\n        this.keycloakConfig = null;\n        this.noWelcomePage = false;\n\n        this._updateAuth = this._updateAuth.bind(this);\n        this._loginStatus = 'unknown';\n\n        this.matomoUrl = '';\n        this.matomoSiteId = -1;\n        this.matomo = null;\n\n        this._attrObserver = new MutationObserver(this.onAttributeObserved);\n\n        this.shellName = 'TU Graz';\n        this.shellSubname= 'Graz University of Technology';\n        this.noBrand = false;\n    }\n\n    static get scopedElements() {\n        return {\n          'dbp-language-select': LanguageSelect,\n          'dbp-tugraz-logo': TUGrazLogo,\n          'dbp-build-info': BuildInfo,\n          'dbp-auth-keycloak': AuthKeycloak,\n          'dbp-auth-menu-button': AuthMenuButton,\n          'dbp-notification': Notification,\n          'dbp-icon': Icon,\n          'dbp-matomo': MatomoElement,\n        };\n    }\n\n    onAttributeObserved(mutationsList, observer) {\n        for(let mutation of mutationsList) {\n            if (mutation.type === 'attributes') {\n                const key = mutation.attributeName;\n                const value = mutation.target.getAttribute(key);\n                sessionStorage.setItem('dbp-attr-' + key, value);\n            }\n        }\n    }\n\n    /**\n     * Fetches the metadata of the components we want to use in the menu, dynamically imports the js modules for them,\n     * then triggers a rebuilding of the menu and resolves the current route\n     *\n     * @param {string} topicURL The topic metadata URL or relative path to load things from\n     */\n    async fetchMetadata(topicURL) {\n        let metadata = {};\n        let routes = [];\n\n        const result = await (await fetch(topicURL, {\n            headers: {'Content-Type': 'application/json'}\n        })).json();\n\n        this.topic = result;\n\n        const fetchOne = async (url) => {\n              const result = await fetch(url, {\n                headers: {'Content-Type': 'application/json'}\n            });\n            if (!result.ok)\n                throw result;\n\n            const jsondata = await result.json();\n            if (jsondata[\"element\"] === undefined)\n                throw new Error(\"no element defined in metadata\");\n\n            return jsondata;\n        };\n\n        let promises = [];\n        for (const activity of result.activities) {\n            const actURL = new URL(activity.path, new URL(topicURL, window.location).href).href;\n            promises.push([activity.visible === undefined || activity.visible, actURL, fetchOne(actURL)]);\n        }\n\n        for (const [visible, actURL, p] of promises) {\n            try {\n                const activity = await p;\n                activity.visible = visible;\n                // Resolve module_src relative to the location of the json file\n                activity.module_src = new URL(activity.module_src, actURL).href;\n                metadata[activity.routing_name] = activity;\n                routes.push(activity.routing_name);\n            } catch (error) {\n                console.log(error);\n            }\n        }\n\n        if (!this.noWelcomePage) {\n            // Inject the welcome activity\n            routes.unshift(\"welcome\");\n            metadata = Object.assign(metadata, {\n                \"welcome\": appWelcomeMeta,\n            });\n            customElements.get(\"dbp-app-shell-welcome\").app = this;\n        }\n\n        // this also triggers a rebuilding of the menu\n        this.metadata = metadata;\n        this.routes = routes;\n\n        // Switch to the first route if none is selected\n        if (!this.activeView)\n            this.switchComponent(routes[0]);\n        else\n            this.switchComponent(this.activeView);\n\n    }\n\n    initRouter() {\n        const routes = [\n            {\n                path: '',\n                action: (context) => {\n                    return {\n                        lang: this.lang,\n                        component: '',\n                    };\n                }\n            },\n            {\n                path: '/:lang',\n                children: [\n                    {\n                        path: '',\n                        action: (context, params) => {\n                            return {\n                                lang: params.lang,\n                                component: '',\n                            };\n                        }\n                    },\n                    {\n                        name: 'mainRoute',\n                        path: '/:component',\n                        action: (context, params) => {\n                            // remove the additional parameters added by Keycloak\n                            let componentTag = params.component.toLowerCase().replace(/&.+/,\"\");\n                            return {\n                                lang: params.lang,\n                                component: componentTag,\n                            };\n                        },\n                    },\n                ],\n            },\n        ];\n\n        this.router = new Router(routes, {\n            routeName: 'mainRoute',\n            getState: () => {\n                return {\n                    component: this.activeView,\n                    lang: this.lang,\n                };\n            },\n            setState: (state) => {\n                this.updateLangIfChanged(state.lang);\n                this.switchComponent(state.component);\n            }\n        }, {\n            baseUrl: new URL(this.basePath, window.location).pathname.replace(/\\/$/, ''),\n        });\n\n        this.router.setStateFromCurrentLocation();\n    }\n\n    static get properties() {\n        return {\n            lang: { type: String, reflect: true },\n            src: { type: String },\n            basePath: { type: String, attribute: 'base-path' },\n            activeView: { type: String, attribute: false},\n            entryPointUrl: { type: String, attribute: 'entry-point-url' },\n            keycloakConfig: { type: Object, attribute: 'keycloak-config' },\n            metadata: { type: Object, attribute: false },\n            topic: { type: Object, attribute: false },\n            subtitle: { type: String, attribute: false },\n            description: { type: String, attribute: false },\n            _loginStatus: { type: Boolean, attribute: false },\n            matomoUrl: { type: String, attribute: \"matomo-url\" },\n            matomoSiteId: { type: Number, attribute: \"matomo-site-id\" },\n            noWelcomePage: { type: Boolean, attribute: \"no-welcome-page\" },\n            shellName: { type: String, attribute: \"shell-name\" },\n            shellSubname: { type: String, attribute: \"shell-subname\" },\n            noBrand: { type: Boolean, attribute: \"no-brand\" }\n        };\n    }\n\n    _updateAuth(login) {\n        if (login.status != this._loginStatus) {\n            console.log('Login status: ' + login.status);\n        }\n\n        this._loginStatus = login.status;\n\n        // Clear the session storage when the user logs out\n        if (this._loginStatus === 'logging-out') {\n            sessionStorage.clear();\n        }\n    }\n\n    connectedCallback() {\n        super.connectedCallback();\n\n        this._bus = new EventBus();\n\n        if (this.src)\n            this.fetchMetadata(this.src);\n        this.initRouter();\n\n        this._bus.subscribe('auth-update', this._updateAuth);\n\n        this.updateComplete.then(()=> {\n            this.matomo = this.shadowRoot.querySelector(this.constructor.getScopedTagName('dbp-matomo'));\n        });\n    }\n\n    disconnectedCallback() {\n        this._bus.close();\n        super.disconnectedCallback();\n    }\n\n    /**\n     * Switches language if another language is requested\n     *\n     * @param {string} lang\n     */\n    updateLangIfChanged(lang) {\n        if (this.lang !== lang) {\n            this.lang = lang;\n            this.router.update();\n\n            const event = new CustomEvent(\"dbp-language-changed\", {\n                bubbles: true,\n                detail: {'lang': lang}\n            });\n\n            this.dispatchEvent(event);\n        }\n    }\n\n    update(changedProperties) {\n        changedProperties.forEach((oldValue, propName) => {\n            if (propName === \"lang\") {\n                // For screen readers\n                document.documentElement.setAttribute(\"lang\", this.lang);\n                i18n.changeLanguage(this.lang);\n            }\n        });\n\n        super.update(changedProperties);\n    }\n\n    onMenuItemClick(e) {\n        e.preventDefault();\n\n        // if not the current page was clicked we need to check if the page can be left\n        if (!e.currentTarget.className.includes(\"selected\")) {\n            // simulate a \"beforeunload\" event\n            const event = new CustomEvent(\"beforeunload\", {\n                bubbles: true,\n                cancelable: true,\n            });\n\n            const eventResult = window.dispatchEvent(event);\n\n            // if someone canceled the \"beforeunload\" event we don't want to leave the page\n            if (!eventResult) {\n                return;\n            }\n        }\n\n        const link = e.composedPath()[0];\n        const location = link.getAttribute('href');\n        this.router.updateFromPathname(location);\n        this.hideMenu();\n    }\n\n    onLanguageChanged(e) {\n        const newLang = e.detail.lang;\n        const changed = (this.lang !== newLang);\n        this.lang = newLang;\n        if (changed) {\n            this.router.update();\n            this.subtitle = this.activeMetaDataText(\"short_name\");\n            this.description = this.activeMetaDataText(\"description\");\n        }\n    }\n\n    switchComponent(componentTag) {\n        const changed = (componentTag !== this.activeView);\n        this.activeView = componentTag;\n        if (changed)\n            this.router.update();\n        const metadata = this.metadata[componentTag];\n\n        if (metadata === undefined) {\n            return;\n        }\n\n        let updateFunc = () => {\n            if (window.pageYOffset !== 0) {\n                window.scrollTo(0, 96);\n            }\n            this.updatePageTitle();\n            this.subtitle = this.activeMetaDataText(\"short_name\");\n            this.description = this.activeMetaDataText(\"description\");\n           \n        };\n\n        // If it is empty assume the element is already registered through other means\n        if (!metadata.module_src) {\n            updateFunc();\n            return;\n        }\n\n        importNotify(import(metadata.module_src)).then(() => {\n            updateFunc();\n        }).catch((e) => {\n            console.error(`Error loading ${ metadata.element }`);\n            throw e;\n        });\n    }\n\n    metaDataText(routingName, key) {\n        const metadata = this.metadata[routingName];\n        return metadata !== undefined && metadata[key] !== undefined ? metadata[key][this.lang] : '';\n    }\n\n    topicMetaDataText(key) {\n        return (this.topic[key] !== undefined) ? this.topic[key][this.lang] : '';\n    }\n\n    activeMetaDataText(key) {\n        return this.metaDataText(this.activeView, key);\n    }\n\n    updatePageTitle() {\n        document.title = `${this.topicMetaDataText('name')} - ${this.activeMetaDataText(\"short_name\")}`;\n    }\n\n    toggleMenu() {\n        const menu = this.shadowRoot.querySelector(\"ul.menu\");\n\n        if (menu === null) {\n            return;\n        }\n\n        menu.classList.toggle('hidden');\n\n        const chevron = this.shadowRoot.querySelector(\"#menu-chevron-icon\");\n        if (chevron !== null) {\n            chevron.name = menu.classList.contains('hidden') ? 'chevron-down' : 'chevron-up';\n        }\n    }\n\n    hideMenu() {\n        const menu = this.shadowRoot.querySelector(\"ul.menu\");\n        if (menu && !menu.classList.contains('hidden'))\n            this.toggleMenu();\n    }\n\n    static get styles() {\n        // language=css\n        return css`\n            ${commonStyles.getThemeCSS()}\n            ${commonStyles.getGeneralCSS()}\n\n            .hidden {display: none}\n\n            h1.title {\n                margin-bottom: 0;\n                font-weight: 300;\n            }\n\n            #main {\n                display: grid;\n                grid-template-columns: minmax(180px, 17%) minmax(0, auto);\n                grid-template-rows: min-content min-content 1fr min-content;\n                grid-template-areas: \"header header\" \"headline headline\" \"sidebar main\" \"footer footer\";\n                max-width: 1400px;\n                margin: auto;\n                min-height: 100vh;\n            }\n\n            #main-logo {\n                padding: 0 50px 0 0;\n            }\n\n            header {\n                grid-area: header;\n                display: grid;\n                grid-template-columns: 50% 1px auto;\n                grid-template-rows: 60px 60px;\n                grid-template-areas: \"hd1-left hd1-middle hd1-right\" \"hd2-left . hd2-right\";\n                width: 100%;\n                max-width: 1060px;\n                margin: 0 auto;\n            }\n\n            aside { grid-area: sidebar; margin: 15px 15px; }\n            #headline { grid-area: headline; margin: 10px; text-align: center; }\n            main { grid-area: main; margin: 15px 15px; }\n            footer { grid-area: footer; margin: 15px; text-align: right; }\n\n            header .hd1-left {\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                grid-area: hd1-left;\n                text-align: right;\n                padding-right: 20px;\n            }\n\n            header .hd1-middle {\n                grid-area: hd1-middle;\n                background-color: #000;\n                background: linear-gradient(180deg, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 85%, rgba(0,0,0,0) 90%);\n            }\n\n            header .hd1-right {\n                grid-area: hd1-right;\n                display: flex;\n                justify-content: flex-start;\n                padding: 0 20px;\n                min-width: 0;\n                align-items: center;\n            }\n\n            header .hd1-right .auth-button {\n                min-width: 0;\n            }\n\n            header .hd2-left {\n                grid-area: hd2-left;\n                display: flex;\n                flex-direction: column;\n                white-space: nowrap;\n            }\n\n            header .hd2-left .header {\n                margin-left: 50px;\n            }\n\n            header .hd2-left a:hover {\n                color: #fff;\n                background-color: #000;\n            }\n\n            header .hd2-right {\n                grid-area: hd2-right;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                text-align: right;\n            }\n\n            header a {\n                color: black;\n                display: inline;\n            }\n\n            aside ul.menu, footer ul.menu {\n                list-style: none;\n            }\n\n            ul.menu li.close {\n                display: none;\n            }\n\n            footer {\n                display: flex;\n                justify-content: flex-end;\n                flex-wrap: wrap;\n            }\n\n            footer > * {\n                margin: 0.5em 0 0 1em;\n            }\n\n            footer a {\n                border-bottom: 1px solid rgba(0,0,0,0.3);\n                padding: 0;\n            }\n\n            footer a:hover {\n                color: #fff;\n                background-color: #000;\n            }\n\n            /* We don't allown inline-svg */\n            /*\n            footer .int-link-external::after {\n                content: \"\\\\00a0\\\\00a0\\\\00a0\\\\00a0\";\n                background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg%20xmlns%3Ardf%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2F02%2F22-rdf-syntax-ns%23%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20height%3D%225.6842mm%22%20width%3D%225.6873mm%22%20version%3D%221.1%22%20xmlns%3Acc%3D%22http%3A%2F%2Fcreativecommons.org%2Fns%23%22%20xmlns%3Adc%3D%22http%3A%2F%2Fpurl.org%2Fdc%2Felements%2F1.1%2F%22%20viewBox%3D%220%200%2020.151879%2020.141083%22%3E%3Cg%20transform%3D%22translate(-258.5%20-425.15)%22%3E%3Cpath%20style%3D%22stroke-linejoin%3Around%3Bstroke%3A%23000%3Bstroke-linecap%3Around%3Bstroke-width%3A1.2%3Bfill%3Anone%22%20d%3D%22m266.7%20429.59h-7.5029v15.002h15.002v-7.4634%22%2F%3E%3Cpath%20style%3D%22stroke-linejoin%3Around%3Bstroke%3A%23000%3Bstroke-linecap%3Around%3Bstroke-width%3A1.2%3Bfill%3Anone%22%20d%3D%22m262.94%20440.86%2015.002-15.002%22%2F%3E%3Cpath%20style%3D%22stroke-linejoin%3Around%3Bstroke%3A%23000%3Bstroke-linecap%3Around%3Bstroke-width%3A1.2%3Bfill%3Anone%22%20d%3D%22m270.44%20425.86h7.499v7.499%22%2F%3E%3C%2Fg%3E%3C%2Fsvg%3E');\n                background-size:contain;\n                background-repeat: no-repeat;\n                background-position:center center;\n                margin: 0 0.5% 0 1.5%;\n                font-size:94%;\n            } \n            */\n\n            .menu a {\n                padding: 0.3em;\n                font-weight: 300;\n                color: #000;\n                display: block;\n            }\n\n            .menu a:hover {\n                color: #E4154B;\n            }\n\n            .menu a.selected {\n                color: var(--dbp-light);\n                background-color: var(--dbp-dark);\n            }\n\n            aside .subtitle {\n                display: none;\n                color: #4a4a4a;\n                font-size: 1.25rem;\n                font-weight: 300;\n                line-height: 1.25;\n                cursor: pointer;\n                text-align: center;\n            }\n\n            ul.menu.hidden {\n                display: block;\n            }\n\n            a { transition: background-color 0.15s ease 0s, color 0.15s ease 0s; }\n\n            .description {\n                text-align: left;\n                margin-bottom: 1rem;\n                display: none;\n            }\n\n            @media (max-width: 680px) {\n                #main {\n                    grid-template-columns: minmax(0, auto);\n                    grid-template-rows: min-content min-content min-content 1fr min-content;\n                    grid-template-areas: \"header\" \"headline\" \"sidebar\" \"main\" \"footer\";\n                }\n\n                header {\n                    grid-template-rows: 40px;\n                    grid-template-areas: \"hd1-left hd1-middle hd1-right\";\n                }\n\n                header .hd2-left, header .hd2-right {\n                    display: none;\n                }\n\n                aside {\n                    margin: 0;\n                    position: sticky;\n                    top: 0;\n                    width: 100%;\n                    background-color: white;\n                    z-index: 10;\n                }\n\n                aside h2.subtitle {\n                    display: block;\n                    border-bottom: 1px solid black;\n                    padding: 0.5em 0.5em;\n                }\n\n                aside .menu {\n                    border-bottom: black 1px solid;\n                    border-top-width: 0;\n                    width: 100%;\n                    position: absolute;\n                    background-color: white;\n                    z-index: 10;\n                    overflow-y: scroll;\n                    white-space: nowrap;\n                }\n\n                .menu li {\n                    padding: 7px;\n                }\n\n                .menu a {\n                    padding: 8px;\n                }\n\n                ul.menu li.close {\n                    display: block;\n                    padding: 0 15px 15px 15px;\n                    text-align: right;\n                    cursor: pointer;\n                }\n\n                ul.menu.hidden {\n                    display: none;\n                }\n            }\n        `;\n    }\n\n    _createActivityElement(activity) {\n        // We have to create elements dynamically based on a tag name which isn't possible with lit-html.\n        // This means we pass the finished element to lit-html and have to handle element caching and\n        // event binding ourselves.\n\n        if (this._lastElm !== undefined) {\n            if (this._lastElm.tagName.toLowerCase() == activity.element.toLowerCase()) {\n                return this._lastElm;\n            } else {\n                this._onActivityRemoved(this._lastElm);\n                this._lastElm = undefined;\n            }\n        }\n\n        this.track('renderActivity', activity.element);\n\n        const elm = document.createElement(activity.element);\n        this._onActivityAdded(elm);\n        this._lastElm = elm;\n        return elm;\n    }\n\n    _onActivityAdded(element) {\n        for(const key of this.topic.attributes || []) {\n            let value = sessionStorage.getItem('dbp-attr-' + key);\n            if (value !== null) {\n                element.setAttribute(key, value);\n            }\n        }\n        this._attrObserver.observe(element, {attributes: true, attributeFilter: this.topic.attributes});\n    }\n\n    _onActivityRemoved(element) {\n        this._attrObserver.disconnect();\n    }\n\n    track(action, message) {\n        if (this.matomo !== null) {\n            this.matomo.track(action, message);\n        }\n    }\n\n    _renderActivity() {\n        const act = this.metadata[this.activeView];\n        if (act === undefined)\n            return html``;\n\n        const elm =  this._createActivityElement(act);\n        elm.setAttribute(\"entry-point-url\", this.entryPointUrl);\n        elm.setAttribute(\"lang\", this.lang);\n        return elm;\n    }\n\n    render() {\n        const getSelectClasses = (name => {\n            return classMap({selected: this.activeView === name});\n        });\n\n        // We hide the app until we are either fully logged in or logged out\n        // At the same time when we hide the main app we show the main slot (e.g. a loading spinner)\n        const appHidden = (this._loginStatus == 'unknown' || this._loginStatus == 'logging-in');\n        const mainClassMap = classMap({hidden: appHidden});\n        const slotClassMap = classMap({hidden: !appHidden});\n\n        // XXX: Safari doesn't like CSS being applied to slots or via HTML,\n        // so we have to remove the slow instead of hiding it\n        if (!appHidden) {\n            this.updateComplete.then(() => {\n                const slot = this.shadowRoot.querySelector(\"slot\");\n                if (slot)\n                    slot.remove();\n            });\n        }\n\n        const prodClassMap = classMap({hidden: buildinfo.env === 'production' || buildinfo.env === 'demo'});\n\n        this.updatePageTitle();\n\n        // build the menu\n        let menuTemplates = [];\n        for (let routingName of this.routes) {\n            const data = this.metadata[routingName];\n\n            if (data['visible']) {\n                menuTemplates.push(html`<li><a @click=\"${(e) => this.onMenuItemClick(e)}\" href=\"${this.router.getPathname({component: routingName})}\" data-nav class=\"${getSelectClasses(routingName)}\" title=\"${this.metaDataText(routingName, \"description\")}\">${this.metaDataText(routingName, \"short_name\")}</a></li>`);\n            }\n        }\n\n        const imprintUrl = this.lang === \"en\" ?\n            \"https://www.tugraz.at/en/about-this-page/legal-notice/\" :\n            \"https://www.tugraz.at/ueber-diese-seite/impressum/\";\n\n        const kc = this.keycloakConfig;\n\n        return html`\n            <slot class=\"${slotClassMap}\"></slot>\n            <dbp-auth-keycloak lang=\"${this.lang}\" url=\"${kc.url}\" realm=\"${kc.realm}\" client-id=\"${kc.clientId}\" silent-check-sso-redirect-uri=\"${kc.silentCheckSsoRedirectUri || ''}\" scope=\"${kc.scope || ''}\"  idp-hint=\"${kc.idpHint || ''}\" load-person ?force-login=\"${kc.forceLogin}\" ?try-login=\"${!kc.forceLogin}\"></dbp-auth-keycloak>\n            <dbp-matomo endpoint=\"${this.matomoUrl}\" site-id=\"${this.matomoSiteId}\"></dbp-matomo>\n            <div class=\"${mainClassMap}\">\n            <div id=\"main\">\n                <dbp-notification lang=\"${this.lang}\"></dbp-notification>\n                <header>\n                    <div class=\"hd1-left\">\n                        <dbp-language-select @dbp-language-changed=${this.onLanguageChanged.bind(this)}></dbp-language-select>\n                    </div>\n                    <div class=\"hd1-middle\">\n                    </div>\n                    <div class=\"hd1-right\">\n                        <dbp-auth-menu-button class=\"auth-button\" lang=\"${this.lang}\"></dbp-auth-menu-button>\n                    </div>\n                    <div class=\"hd2-left\">\n                        <div class=\"header\">\n                            ${this.shellName}<br>${this.shellSubname}\n                        </div>\n                    </div>\n                    <div class=\"hd2-right\">\n                        <dbp-tugraz-logo id=\"main-logo\" lang=\"${this.lang}\" class=\"${classMap({hidden: this.noBrand})}\"></dbp-tugraz-logo>\n                    </div>\n                </header>\n\n                <div id=\"headline\">\n                    <h1 class=\"title\">${this.topicMetaDataText('name')}</h1>\n                </div>\n                <aside>\n                    <h2 class=\"subtitle\" @click=\"${this.toggleMenu}\">\n                        ${this.subtitle}\n                        <dbp-icon name=\"chevron-down\" style=\"color: red\" id=\"menu-chevron-icon\"></dbp-icon>\n                    </h2>\n                    <ul class=\"menu hidden\">\n                        ${menuTemplates}\n                        <li class=\"close\" @click=\"${this.hideMenu}\"><dbp-icon name=\"close\" style=\"color: red\"></dbp-icon></li>\n                    </ul>\n                </aside>\n\n                <main>\n                    <p class=\"description\">${this.description}</p>\n                    ${ this._renderActivity() }\n                </main>\n\n                <footer>\n                    <a target=\"_blank\" rel=\"noopener\" class=\"int-link-external\" href=\"https://datenschutz.tugraz.at/erklaerung/\">${i18n.t('privacy-policy')}</a>\n                    <a target=\"_blank\" rel=\"noopener\" class=\"int-link-external\" href=\"${imprintUrl}\">${i18n.t('imprint')}</a>\n                    <a rel=\"noopener\" class=\"int-link-external\" href=\"mailto:it-support@tugraz.at\">${i18n.t('contact')}</a>\n                    <dbp-build-info class=\"${prodClassMap}\"></dbp-build-info>\n                </footer>\n            </div>\n            </div>\n        `;\n    }\n}","import {AppShell} from '@dbp-toolkit/app-shell';\nimport * as commonUtils from '@dbp-toolkit/common/utils';\n\ncommonUtils.defineCustomElement('vc4sm-frontend', AppShell);\n"],"names":["checkIndentifier","name","allowEmpty","length","test","Error","JSON","stringify","EventBus","constructor","options","_busName","_retainedData","_retainedListeners","_listeners","_name","operation","busName","eventName","result","undefined","createEventName","this","subscribe","callback","listeners","Map","has","eventHandler","e","meta","detail","retain","data","preventDefault","window","addEventListener","set","fetchEvent","CustomEvent","dispatchEvent","unsubscribe","get","removeEventListener","delete","publish","retainedEventHandler","stopImmediatePropagation","event","cancelable","close","funcs","Object","entries","retainedHandler","handler","callbacks","keys","i18n","createInstance","en","de","createI18nInstance","cloneInstance","LanguageSelect","LitElement","_lang","languages","onExternalChange","bind","t","_getNextLanguage","lang","index","indexOf","next","_getPreviousLanguage","prev","type","String","Array","value","oldValue","oldNext","requestUpdate","bubbles","composed","changeLanguage","commonStyles.getThemeCSS","css","connectedCallback","disconnectedCallback","document","onClick","render","linkTitle","html","toUpperCase","send","alert","summary","body","console","log","instances","successFunctions","failureFunctions","initStarted","JSONLD","baseApiUrl","entities","idToEntityNameMatchList","entityName","apiUrl","successFnc","failureFnc","push","DBPAuthToken","doInitialization","xhr","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","status","json","parse","responseText","entryPoints","property","startsWith","toLowerCase","apiDocUrl","utils.parseLinkHeader","getResponseHeader","docXhr","gatherEntities","executeFailureFunctions","supportedClasses","baseUrl","utils.parseBaseUrl","forEach","classData","entryPoint","instance","fnc","message","notify","getEntityForIdentifier","identifier","getEntityNameForIdentifier","getEntityForEntityName","getApiUrlForIdentifier","entity","getApiUrlForEntityName","getApiIdentifierList","expandMember","member","context","key","compactMember","localContext","transformMembers","members","otherContext","results","that","privateData","WeakMap","wrappers","pd","retv","assert","setCancelFlag","passiveListener","canceled","error","Event","eventTarget","eventPhase","currentTarget","stopped","immediateStopped","timeStamp","Date","now","defineProperty","enumerable","i","defineRedirectDescriptor","configurable","defineCallDescriptor","apply","arguments","getWrapper","proto","prototype","wrapper","BaseEvent","call","create","writable","isFunc","getOwnPropertyDescriptor","defineWrapper","getPrototypeOf","isStopped","setPassiveListener","composedPath","stopPropagation","Boolean","cancelBubble","initEvent","setPrototypeOf","listenersMap","isObject","x","getListeners","TypeError","defineEventAttribute","eventTargetPrototype","node","listenerType","listener","newNode","passive","once","defineEventAttributeDescriptor","defineCustomEventTarget","eventNames","CustomEventTarget","EventTarget","isArray","types","async","importKeycloak","keycloakSrc","import","_keycloakMod","Keycloak","optionsIsObj","capture","wrappedEvent","wrapEvent","err","handleEvent","setEventPhase","setCurrentTarget","defaultPrevented","KeycloakWrapper","baseURL","realm","clientId","silentCheckSsoUri","idpHint","_baseURL","_realm","_clientId","_keycloak","_initDone","_silentCheckSsoUri","_idpHint","_checkId","MIN_VALIDITY","CHECK_INTERVAL","DEBUG","_onVisibilityChanged","visibilityState","authenticated","_checkTokeHasExpired","_onChanged","_onReady","refreshed","updateToken","minValidity","clearInterval","setInterval","url","onTokenExpired","_onTokenExpired","onAuthRefreshSuccess","onAuthRefreshError","onAuthLogout","_onAuthLogout","onAuthSuccess","_onAuthSuccess","onAuthError","onReady","init","_ensureInstance","promiseType","pkceMethod","urlOrPath","URL","href","location","ensureURL","ms","promise","timeout","Promise","resolve","reject","id","setTimeout","clearTimeout","race","promiseTimeout","_keycloakInit","catch","isLoggingIn","search","_ensureInit","language","scope","login","kcLocale","locale","clearToken","logout","LoginStatus","freeze","UNKNOWN","LOGGING_IN","LOGGED_IN","LOGGING_OUT","LOGGED_OUT","AuthKeycloak","forceLogin","loadPerson","token","tokenParsed","subject","personId","tryLogin","person","entryPointUrl","commonUtils.getAPiUrl","_loginStatus","keycloakUrl","silentCheckSsoRedirectUri","personInitEvent","keycloakDataUpdateEvent","_onKCChanged","update","changedProperties","propName","kc","newPerson","tokenChanged","idTokenParsed","preferred_username","DBPAuthSubject","DBPAuthTokenParsed","DBPUserFullName","DBPPersonId","DBPPerson","_setLoginStatus","initialize","jsonld","fetch","headers","then","response","force","_bus","attribute","_kcwrapper","_this2","handleLogin","ScopedElementsMixin","AuthMenuButton","showImage","_loginData","closeDropdown","onWindowResize","Icon","updateDropdownWidth","dropdown","shadowRoot","querySelector","viewportOffset","getBoundingClientRect","spaceToRIght","innerWidth","left","setAttribute","onLoginClicked","onLogoutClicked","setChevron","chevron","onDropdownClick","classList","toggle","contains","querySelectorAll","el","remove","renderLoggedIn","imageURL","image","renderLoggedOut","unsafeHTML","loggedIn","Notification","DBPLitElement","notificationBlock","_","notificationId","dt","getTime","replace","c","r","Math","random","floor","toString","createUUID","icon","iconHTML","summaryHTML","innerHTML","messageId","removeMessageId","updateComplete","messageElementId","element","removeChild","commonStyles.getGeneralCSS","commonStyles.getNotificationCSS","str","tokens","char","count","pattern","j","code","charCodeAt","lexer","_a","prefixes","defaultPattern","escapeString","delimiter","path","tryConsume","mustConsume","nextType","consumeText","prefix","suffix","modifier","name_1","pattern_1","match","re","decode","pathname","m","exec","params","_loop_1","split","map","regexpToFunction","pathToRegexp","flags","sensitive","stringToRegexp","strict","_b","start","_c","end","_d","encode","endsWith","route","_i","tokens_1","mod","endToken","isEndDelimited","RegExp","tokensToRegexp","groupsRegex","execResult","source","regexpToRegexp","paths","parts","join","arrayToRegexp","val","decodeURIComponent","matchRoute","parentParams","matchResult","childMatches","childIndex","routeToSkip","done","rt","children","assign","charAt","substr","childRoute","parent","childMatch","resolveRoute","action","UniversalRouter","routes","root","pathnameOrContext","matches","nextMatches","_this","router","currentContext","resume","prevResult","parentRoute","isChildRoute","errorHandler","cacheRoutes","routesByName","generateUrls","ReferenceError","regexpByRoute","opts","encodeURIComponent","routeName","clear","regexp","fullPath","toPath","reFlags","validate","optional","repeat","segment","typeOfMessage","tokensToFunction","stringifyQueryParams","queryParams","_keys","query","Router","unioptions","getState","setState","setStateFromCurrentLocation","dispatchLocationChanged","oldPathName","page","newPathname","getPathname","referrerUrl","history","replaceState","pushState","updateFromPathname","partialState","combined","BuildInfo","commonStyles.getTagCSS","date","buildinfo","TUGrazLogo","AppShellWelcome","app","_app","metadata","itemTemplates","switchActivity","switchComponent","routing_name","description","appname","topic","appWelcomeMeta","visible","commonUtils.defineCustomElement","MatomoElement","endpoint","siteId","isRunning","lastEvent","Number","setupMatomo","_paq","buildInfo","g","createElement","s","getElementsByTagName","defer","src","parentNode","insertBefore","content","getElementById","stack","track","AppShell","activeView","subtitle","basePath","keycloakConfig","noWelcomePage","_updateAuth","matomoUrl","matomoSiteId","matomo","_attrObserver","MutationObserver","onAttributeObserved","shellName","shellSubname","noBrand","mutationsList","observer","mutation","attributeName","target","getAttribute","sessionStorage","setItem","topicURL","fetchOne","ok","jsondata","promises","activity","activities","actURL","p","module_src","unshift","customElements","initRouter","component","componentTag","state","updateLangIfChanged","reflect","fetchMetadata","getScopedTagName","documentElement","onMenuItemClick","className","includes","hideMenu","onLanguageChanged","newLang","changed","activeMetaDataText","updateFunc","pageYOffset","scrollTo","updatePageTitle","importNotify","metaDataText","routingName","topicMetaDataText","title","toggleMenu","menu","_createActivityElement","_lastElm","tagName","_onActivityRemoved","elm","_onActivityAdded","attributes","getItem","observe","attributeFilter","disconnect","_renderActivity","act","getSelectClasses","classMap","selected","appHidden","mainClassMap","hidden","slotClassMap","slot","prodClassMap","menuTemplates","imprintUrl"],"mappings":"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"}